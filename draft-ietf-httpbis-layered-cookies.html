<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Cookies: HTTP State Management Mechanism</title>
<meta content="Anne van Kesteren" name="author">
<meta content="Johann Hofmann" name="author">
<meta content="
       This document defines the HTTP  Cookie  and  Set-Cookie  header fields. These
header fields can be used by HTTP servers to store state (called cookies) at
HTTP user agents, letting the servers maintain a stateful session over the
mostly stateless HTTP protocol. Although cookies have many historical
infelicities that degrade their security and privacy, the  Cookie  and  Set-Cookie 
header fields are widely used on the Internet. This document obsoletes RFC
6265 and 6265bis. 
    " name="description">
<meta content="xml2rfc 3.29.0" name="generator">
<meta content="draft-ietf-httpbis-layered-cookies-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.29.0
    Python 3.12.11
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.4
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-httpbis-layered-cookies.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Cookies</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">van Kesteren &amp; Hofmann</td>
<td class="center">Expires 29 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">HTTP</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-httpbis-layered-cookies-latest</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc[6265]" class="eref">[6265]</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-27" class="published">27 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-29">29 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. van Kesteren, <span class="editor">Ed.</span>
</div>
<div class="org">Apple</div>
</div>
<div class="author">
      <div class="author-name">J. Hofmann, <span class="editor">Ed.</span>
</div>
<div class="org">Google</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Cookies: HTTP State Management Mechanism</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines the HTTP <code>Cookie</code> and <code>Set-Cookie</code> header fields. These
header fields can be used by HTTP servers to store state (called cookies) at
HTTP user agents, letting the servers maintain a stateful session over the
mostly stateless HTTP protocol. Although cookies have many historical
infelicities that degrade their security and privacy, the <code>Cookie</code> and <code>Set-Cookie</code>
header fields are widely used on the Internet. This document obsoletes RFC
6265 and 6265bis.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-layered-cookies/">https://datatracker.ietf.org/doc/draft-ietf-httpbis-layered-cookies/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        HTTP Working Group mailing list (<span><a href="mailto:ietf-http-wg@w3.org">mailto:ietf-http-wg@w3.org</a></span>),
        which is archived at <span><a href="https://lists.w3.org/Archives/Public/ietf-http-wg/">https://lists.w3.org/Archives/Public/ietf-http-wg/</a></span>.
        Working Group information can be found at <span><a href="https://httpwg.org/">https://httpwg.org/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/httpwg/http-extensions/labels/cookies">https://github.com/httpwg/http-extensions/labels/cookies</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 29 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-3">
            This document may contain material from IETF Documents or IETF
            Contributions published or made publicly available before November
            10, 2008. The person(s) controlling the copyright in some of this
            material may not have granted the IETF Trust the right to allow
            modifications of such material outside the IETF Standards Process.
            Without obtaining an adequate license from the person(s)
            controlling the copyright in such materials, this document may not
            be modified outside the IETF Standards Process, and derivative
            works of it may not be created outside the IETF Standards Process,
            except to format it for publication as an RFC or to translate it
            into languages other than English.<a href="#section-boilerplate.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions" class="internal xref">Conventions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-abnf" class="internal xref">ABNF</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-which-requirements-to-imple" class="internal xref">Which Requirements to Implement</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-cookie-producing-implementa" class="internal xref">Cookie Producing Implementations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-cookie-consuming-implementa" class="internal xref">Cookie Consuming Implementations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-programming-languages-softw" class="internal xref">Programming Languages &amp; Software Frameworks</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-server-requirements" class="internal xref">Server Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-set-cookie" class="internal xref">Set-Cookie</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-syntax" class="internal xref">Syntax</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-semantics-non-normative" class="internal xref">Semantics (Non-Normative)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-cookie-name-prefixes" class="internal xref">Cookie Name Prefixes</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-cookie" class="internal xref">Cookie</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-syntax-2" class="internal xref">Syntax</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-semantics" class="internal xref">Semantics</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-user-agent-requirements" class="internal xref">User Agent Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-cookie-concepts" class="internal xref">Cookie Concepts</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-cookie-store-and-limits" class="internal xref">Cookie Store And Limits</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-cookie-struct" class="internal xref">Cookie Struct</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-cookie-store-eviction" class="internal xref">Cookie Store Eviction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-remove-expired-cookies" class="internal xref">Remove Expired Cookies</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-remove-excess-cookies-for-a" class="internal xref">Remove Excess Cookies for a Host</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-remove-global-excess-cookie" class="internal xref">Remove Global Excess Cookies</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-subcomponent-algorithms" class="internal xref">Subcomponent Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="auto internal xref">5.3.1</a>.  <a href="#name-parse-a-date" class="internal xref">Parse a Date</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="auto internal xref">5.3.2</a>.  <a href="#name-domain-matching" class="internal xref">Domain Matching</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="auto internal xref">5.3.3</a>.  <a href="#name-cookie-default-path" class="internal xref">Cookie Default Path</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4">
                    <p id="section-toc.1-1.5.2.3.2.4.1"><a href="#section-5.3.4" class="auto internal xref">5.3.4</a>.  <a href="#name-path-matching" class="internal xref">Path Matching</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-main-algorithms" class="internal xref">Main Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="auto internal xref">5.4.1</a>.  <a href="#name-parse-and-store-a-cookie" class="internal xref">Parse and Store a Cookie</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="auto internal xref">5.4.2</a>.  <a href="#name-parse-a-cookie" class="internal xref">Parse a Cookie</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.3">
                    <p id="section-toc.1-1.5.2.4.2.3.1"><a href="#section-5.4.3" class="auto internal xref">5.4.3</a>.  <a href="#name-store-a-cookie" class="internal xref">Store a Cookie</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.4">
                    <p id="section-toc.1-1.5.2.4.2.4.1"><a href="#section-5.4.4" class="auto internal xref">5.4.4</a>.  <a href="#name-garbage-collect-cookies" class="internal xref">Garbage Collect Cookies</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.5">
                    <p id="section-toc.1-1.5.2.4.2.5.1"><a href="#section-5.4.5" class="auto internal xref">5.4.5</a>.  <a href="#name-retrieve-cookies" class="internal xref">Retrieve Cookies</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.6">
                    <p id="section-toc.1-1.5.2.4.2.6.1"><a href="#section-5.4.6" class="auto internal xref">5.4.6</a>.  <a href="#name-serialize-cookies" class="internal xref">Serialize Cookies</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="auto internal xref">5.5</a>.  <a href="#name-requirements-specific-to-no" class="internal xref">Requirements Specific to Non-Browser User Agents</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a href="#section-5.5.1" class="auto internal xref">5.5.1</a>.  <a href="#name-the-set-cookie-header-field" class="internal xref">The Set-Cookie Header Field</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.2">
                    <p id="section-toc.1-1.5.2.5.2.2.1"><a href="#section-5.5.2" class="auto internal xref">5.5.2</a>.  <a href="#name-the-cookie-header-field" class="internal xref">The Cookie Header Field</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.3">
                    <p id="section-toc.1-1.5.2.5.2.3.1"><a href="#section-5.5.3" class="auto internal xref">5.5.3</a>.  <a href="#name-cookie-store-eviction-for-n" class="internal xref">Cookie Store Eviction for Non-Browser User Agents</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="auto internal xref">5.6</a>.  <a href="#name-requirements-specific-to-br" class="internal xref">Requirements Specific to Browser User Agents</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-implementation-consideratio" class="internal xref">Implementation Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-limits" class="internal xref">Limits</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-application-programming-int" class="internal xref">Application Programming Interfaces</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-third-party-cookies" class="internal xref">Third-Party Cookies</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-cookie-policy" class="internal xref">Cookie Policy</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-user-controls" class="internal xref">User Controls</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-expiration-dates" class="internal xref">Expiration Dates</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-ambient-authority" class="internal xref">Ambient Authority</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-clear-text" class="internal xref">Clear Text</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-session-identifiers" class="internal xref">Session Identifiers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-weak-confidentiality" class="internal xref">Weak Confidentiality</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.6">
                <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-weak-integrity" class="internal xref">Weak Integrity</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.7">
                <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="auto internal xref">8.7</a>.  <a href="#name-reliance-on-dns" class="internal xref">Reliance on DNS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.8">
                <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="auto internal xref">8.8</a>.  <a href="#name-samesite-cookies" class="internal xref">SameSite Cookies</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-cookie-2" class="internal xref">Cookie</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-set-cookie-2" class="internal xref">Set-Cookie</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-changes" class="internal xref">Changes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref"></a><a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref"></a><a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref"></a><a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document defines the HTTP <code>Cookie</code> and <code>Set-Cookie</code> header fields. Using
the <code>Set-Cookie</code> header field, an HTTP server can pass name/value pairs and
associated metadata (called cookies) to a user agent. When the user agent makes
subsequent requests to the server, the user agent uses the metadata and other
information to determine whether to return the name/value pairs in the <code>Cookie</code>
header field.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Although simple on their surface, cookies have a number of complexities. For
example, the server can scope the maximum amount of time during which the user
agent should return the cookie, the servers to which the user agent should
return the cookie, and whether the cookie can be accessed through a non-HTTP
API, such as JavaScript in a web browser.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">For historical reasons, cookies contain a number of security and privacy
infelicities. For example, a server can indicate that a given cookie is
intended for "secure" connections, but the cookie's Secure attribute does not provide
integrity in the presence of an active network attacker. Similarly, cookies
for a given host are shared across all the ports on that host, even though the
usual "same-origin policy" used by web browsers isolates content retrieved via
different ports.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document specifies the syntax and semantics of these header fields. Where some
existing software differs from the requirements in significant ways, the document
contains a note explaining the difference.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">This document obsoletes <span>[<a href="#RFC6265" class="cite xref">RFC6265</a>]</span> and 6265bis.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="examples">
<section id="section-1.1">
        <h3 id="name-examples">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
        </h3>
<p id="section-1.1-1">Using the <code>Set-Cookie</code> header field, a server can send the user agent a short string
in an HTTP response that the user agent will return in future HTTP requests that
are within the scope of the cookie. For example, the server can send the user
agent a "session identifier" named SID with the value 31d4d96e407aad42. The
user agent then returns the session identifier in subsequent requests.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<div class="lang-example sourcecode" id="section-1.1-2">
<pre>
== Server -&gt; User Agent ==

Set-Cookie: SID=31d4d96e407aad42

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42
</pre><a href="#section-1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-1.1-3">The server can alter the default scope of the cookie using the Path and
Domain attributes. For example, the server can instruct the user agent to
return the cookie to every path and every subdomain of site.example.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<div class="lang-example sourcecode" id="section-1.1-4">
<pre>
== Server -&gt; User Agent ==

Set-Cookie: SID=31d4d96e407aad42; Path=/; Domain=site.example

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42
</pre><a href="#section-1.1-4" class="pilcrow">¶</a>
</div>
<p id="section-1.1-5">As shown in the next example, the server can store multiple cookies at the user
agent. For example, the server can store a session identifier as well as the
user's preferred language by returning two <code>Set-Cookie</code> header fields. Notice
that the server uses the Secure and HttpOnly attributes to provide
additional security protections for the more sensitive session identifier (see
<a href="#sane-set-cookie-semantics" class="auto internal xref">Section 4.1.2</a>).<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<div class="lang-example sourcecode" id="section-1.1-6">
<pre>
== Server -&gt; User Agent ==

Set-Cookie: SID=31d4d96e407aad42; Path=/; Secure; HttpOnly
Set-Cookie: lang=en-US; Path=/; Domain=site.example

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42; lang=en-US
</pre><a href="#section-1.1-6" class="pilcrow">¶</a>
</div>
<p id="section-1.1-7">Notice that the <code>Cookie</code> header field above contains two cookies, one named SID and
one named lang.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<p id="section-1.1-8">Cookie names are case-sensitive, meaning that if a server sends the user agent
two Set-Cookie header fields that differ only in their name's case the user
agent will store and return both of those cookies in subsequent requests.<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<div class="lang-example sourcecode" id="section-1.1-9">
<pre>
== Server -&gt; User Agent ==

Set-Cookie: SID=31d4d96e407aad42
Set-Cookie: sid=31d4d96e407aad42

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42; sid=31d4d96e407aad42
</pre><a href="#section-1.1-9" class="pilcrow">¶</a>
</div>
<p id="section-1.1-10">If the server wishes the user agent to persist the cookie over
multiple "sessions" (e.g., user agent restarts), the server can specify an
expiration date in the Expires attribute. Note that the user agent might
delete the cookie before the expiration date if the user agent's cookie store
exceeds its quota or if the user manually deletes the server's cookie.<a href="#section-1.1-10" class="pilcrow">¶</a></p>
<div class="lang-example sourcecode" id="section-1.1-11">
<pre>
== Server -&gt; User Agent ==

Set-Cookie: lang=en-US; Expires=Wed, 09 Jun 2021 10:18:14 GMT

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42; lang=en-US
</pre><a href="#section-1.1-11" class="pilcrow">¶</a>
</div>
<p id="section-1.1-12">Finally, to remove a cookie, the server returns a <code>Set-Cookie</code> header field with an
expiration date in the past. The server will be successful in removing the
cookie only if the Path and the Domain attribute in the <code>Set-Cookie</code> header field
match the values used when the cookie was created.<a href="#section-1.1-12" class="pilcrow">¶</a></p>
<div class="lang-example sourcecode" id="section-1.1-13">
<pre>
== Server -&gt; User Agent ==

Set-Cookie: lang=; Expires=Sun, 06 Nov 1994 08:49:37 GMT

== User Agent -&gt; Server ==

Cookie: SID=31d4d96e407aad42
</pre><a href="#section-1.1-13" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="conventions">
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<div id="terminology">
<section id="section-2.1">
        <h3 id="name-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-2.1-1">This specification depends on Infra. <span>[<a href="#INFRA" class="cite xref">INFRA</a>]</span><a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Some terms used in this specification are defined in the following standards and specifications:<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-3.1">
            <p id="section-2.1-3.1.1">HTTP <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span><a href="#section-2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-3.2">
            <p id="section-2.1-3.2.1">URL <span>[<a href="#URL" class="cite xref">URL</a>]</span><a href="#section-2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-4">A <strong>non-HTTP API</strong> is a non-HTTP mechanisms used to set and retrieve
cookies, such as a web browser API that exposes cookies to JavaScript.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="abnf">
<section id="section-2.2">
        <h3 id="name-abnf">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-abnf" class="section-name selfRef">ABNF</a>
        </h3>
<p id="section-2.2-1">This specification uses the Augmented Backus-Naur Form (ABNF) notation of
<span>[<a href="#RFC5234" class="cite xref">RFC5234</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">The following core rules are included by reference, as defined in <span>[<a href="#RFC5234" class="cite xref">RFC5234</a>]</span>,
Appendix B.1: ALPHA (letters), CR (carriage return), CRLF (CR LF), CTLs
(controls), DIGIT (decimal 0-9), DQUOTE (double quote), HEXDIG
(hexadecimal 0-9/A-F/a-f), LF (line feed), NUL (null octet), OCTET (any
8-bit sequence of data except NUL), SP (space), HTAB (horizontal tab),
CHAR (any ASCII byte), VCHAR (any visible ASCII byte),
and WSP (whitespace).<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">The OWS (optional whitespace) and BWS (bad whitespace) rules are defined in
<span><a href="https://rfc-editor.org/rfc/rfc9110#section-5.6.3" class="relref">Section 5.6.3</a> of [<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-advisory">
<section id="section-3">
      <h2 id="name-which-requirements-to-imple">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-which-requirements-to-imple" class="section-name selfRef">Which Requirements to Implement</a>
      </h2>
<p id="section-3-1">The upcoming two sections, <a href="#server-requirements" class="auto internal xref">Section 4</a> and <a href="#ua-requirements" class="auto internal xref">Section 5</a>, discuss
the set of requirements for two distinct types of implementations. This section
is meant to help guide implementers in determining which set of requirements
best fits their goals. Choosing the wrong set of requirements could result in a
lack of compatibility with other cookie implementations.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">It's important to note that being compatible means different things
depending on the implementer's goals. These differences have built up over time
due to both intentional and unintentional specification changes, specification interpretations,
and historical implementation differences.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">This section roughly divides implementers of this specification into two types,
producers and consumers. These are not official terms and are only used here to
help readers develop an intuitive understanding of the use cases.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="cookie-producing-implementations">
<section id="section-3.1">
        <h3 id="name-cookie-producing-implementa">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-cookie-producing-implementa" class="section-name selfRef">Cookie Producing Implementations</a>
        </h3>
<p id="section-3.1-1">An implementer should choose <a href="#server-requirements" class="auto internal xref">Section 4</a> whenever cookies are created and
will be sent to a user agent, such as a web browser. These implementations are
frequently referred to as servers by the specification but that term includes anything
which primarily produces cookies. Some potential examples:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">Server applications hosting a website or API<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">Programming languages or software frameworks that support cookies<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">Integrated third-party web applications, such as a business management suite<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-3">All these benefit from not only supporting as many user agents as possible but
also supporting other servers. This is useful if a cookie is produced by a
software framework and is later sent back to a server application which needs
to read it. <a href="#server-requirements" class="auto internal xref">Section 4</a> advises best practices that help maximize this
sense of compatibility.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cookie-consuming-implementations">
<section id="section-3.2">
        <h3 id="name-cookie-consuming-implementa">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-cookie-consuming-implementa" class="section-name selfRef">Cookie Consuming Implementations</a>
        </h3>
<p id="section-3.2-1">An implementer should choose <a href="#ua-requirements" class="auto internal xref">Section 5</a> whenever cookies are primarily
received from another source. These implementations are referred to as user
agents. Some examples:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">Web browsers<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">Tools that support stateful HTTP<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.2-2.3">
            <p id="section-3.2-2.3.1">Programming languages or software frameworks that support cookies<a href="#section-3.2-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.2-3">Because user agents don't know which servers a user will access, and whether
or not that server is following best practices, users agents are advised to
implement a more lenient set of requirements and to accept some things that
servers are warned against producing. <a href="#ua-requirements" class="auto internal xref">Section 5</a> advises best
practices that help maximize this sense of compatibility.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="languages-frameworks">
<section id="section-3.3">
        <h3 id="name-programming-languages-softw">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-programming-languages-softw" class="section-name selfRef">Programming Languages &amp; Software Frameworks</a>
        </h3>
<p id="section-3.3-1">A programming language or software framework with support for cookies could
reasonably be used to create an application that acts as a cookie producer,
cookie consumer, or both. Because a developer may want to maximize their
compatibility as either a producer or consumer, these languages or frameworks
should strongly consider supporting both sets of requirements, <a href="#server-requirements" class="auto internal xref">Section 4</a>
and <a href="#ua-requirements" class="auto internal xref">Section 5</a>, behind a compatibility mode toggle. This toggle should
default to <a href="#server-requirements" class="auto internal xref">Section 4</a>'s requirements.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Doing so will reduce the chances that a developer's application can
inadvertently create cookies that cannot be read by other servers.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="server-requirements">
<section id="section-4">
      <h2 id="name-server-requirements">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-server-requirements" class="section-name selfRef">Server Requirements</a>
      </h2>
<p id="section-4-1">This section describes the conforming syntax and semantics of the
HTTP <code>Cookie</code> and <code>Set-Cookie</code> header fields.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="sane-set-cookie">
<section id="section-4.1">
        <h3 id="name-set-cookie">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-set-cookie" class="section-name selfRef">Set-Cookie</a>
        </h3>
<p id="section-4.1-1">The <code>Set-Cookie</code> HTTP response header field is used to send cookies from the server to
the user agent.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Origin servers MAY send a <code>Set-Cookie</code> response header field with any response. An
origin server can include multiple <code>Set-Cookie</code> header fields in a single response.
The presence of a <code>Cookie</code> or a <code>Set-Cookie</code> header field does not preclude HTTP
caches from storing and reusing a response.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Origin servers and intermediaries MUST NOT combine multiple Set-Cookie header
fields into a single header field. The usual mechanism for combining HTTP
headers fields (i.e., as defined in <span><a href="https://rfc-editor.org/rfc/rfc9110#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>) might change
the semantics of the Set-Cookie header field because the %x2C (",") character
is used by Set-Cookie in a way that conflicts with such combining.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">For example,<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-5">
<pre>
Set-Cookie: a=b;path=/c,d=e
</pre><a href="#section-4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1-6">is ambiguous. It could be intended as two cookies, a=b and d=e, or a single
cookie with a path of /c,d=e.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<div id="abnf-syntax">
<section id="section-4.1.1">
          <h4 id="name-syntax">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-syntax" class="section-name selfRef">Syntax</a>
          </h4>
<p id="section-4.1.1-1">Informally, the <code>Set-Cookie</code> response header field contains a cookie, which begins with a
name-value-pair, followed by zero or more attribute-value pairs. Servers
MUST send <code>Set-Cookie</code> header fields that conform to the following grammar:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<div class="lang-abnf sourcecode" id="section-4.1.1-2">
<pre>
set-cookie        = set-cookie-string
set-cookie-string = BWS cookie-pair *( BWS ";" OWS cookie-av )
cookie-pair       = cookie-name BWS "=" BWS cookie-value
cookie-name       = token
cookie-value      = *cookie-octet / ( DQUOTE *cookie-octet DQUOTE )
cookie-octet      = %x21 / %x23-2B / %x2D-3A / %x3C-5B / %x5D-7E
                      ; US-ASCII characters excluding CTLs,
                      ; whitespace, DQUOTE, comma, semicolon,
                      ; and backslash
token             = &lt;token, defined in [HTTP], Section 5.6.2&gt;

cookie-av         = expires-av / max-age-av / domain-av /
                    path-av / secure-av / httponly-av /
                    samesite-av / extension-av
expires-av        = "Expires" BWS "=" BWS sane-cookie-date
sane-cookie-date  =
    &lt;IMF-fixdate, defined in [HTTP], Section 5.6.7&gt;
max-age-av        = "Max-Age" BWS "=" BWS non-zero-digit *DIGIT
non-zero-digit    = %x31-39
                      ; digits 1 through 9
domain-av         = "Domain" BWS "=" BWS domain-value
domain-value      = &lt;subdomain&gt;
                      ; see details below
path-av           = "Path" BWS "=" BWS path-value
path-value        = *av-octet
secure-av         = "Secure"
httponly-av       = "HttpOnly"
samesite-av       = "SameSite" BWS "=" BWS samesite-value
samesite-value    = "Strict" / "Lax" / "None"
extension-av      = *av-octet
av-octet          = %x20-3A / %x3C-7E
                      ; any CHAR except CTLs or ";"
</pre><a href="#section-4.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-3">Note that some of the grammatical terms above reference documents that use
different grammatical notations than this document (which uses ABNF from
<span>[<a href="#RFC5234" class="cite xref">RFC5234</a>]</span>).<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">Per the grammar above, servers MUST NOT produce nameless cookies (i.e., an
empty cookie-name) as such cookies may be unpredictably serialized by user agents when
sent back to the server.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">The semantics of the cookie-value are not defined by this document.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1.1-6">To maximize compatibility with user agents, servers that wish to store arbitrary
data in a cookie-value SHOULD encode that data, for example, using Base64
<span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>.<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1.1-7">Per the grammar above, the cookie-value MAY be wrapped in DQUOTE characters.
Note that in this case, the initial and trailing DQUOTE characters are not
stripped. They are part of the cookie-value, and will be included in <code>Cookie</code>
header fields sent to the server.<a href="#section-4.1.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1.1-8">The domain-value is a subdomain as defined by <span>[<a href="#RFC1034" class="cite xref">RFC1034</a>]</span>, Section 3.5, and
as enhanced by <span>[<a href="#RFC1123" class="cite xref">RFC1123</a>]</span>, Section 2.1. Thus, domain-value is a byte sequence of
ASCII bytes.<a href="#section-4.1.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1.1-9">The portions of the set-cookie-string produced by the cookie-av term are
known as attributes. To maximize compatibility with user agents, servers SHOULD
NOT produce two attributes with the same name in the same set-cookie-string.<a href="#section-4.1.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1.1-10">NOTE: The name of an attribute-value pair is not case-sensitive. So while they
are presented here in CamelCase, such as <code>HttpOnly</code> or <code>SameSite</code>, any case is
accepted. E.g., <code>httponly</code>, <code>Httponly</code>, <code>hTTPoNLY</code>, etc.<a href="#section-4.1.1-10" class="pilcrow">¶</a></p>
<p id="section-4.1.1-11">Servers MUST NOT include more than one <code>Set-Cookie</code> header field in the same
response with the same cookie-name. (See <a href="#set-cookie" class="auto internal xref">Section 5.5.1</a> for how user agents
handle this case.)<a href="#section-4.1.1-11" class="pilcrow">¶</a></p>
<p id="section-4.1.1-12">If a server sends multiple responses containing <code>Set-Cookie</code> header fields
concurrently to the user agent (e.g., when communicating with the user agent
over multiple sockets), these responses create a "race condition" that can lead
to unpredictable behavior.<a href="#section-4.1.1-12" class="pilcrow">¶</a></p>
<p id="section-4.1.1-13">NOTE: Some existing user agents differ in their interpretation of two-digit
years. To avoid compatibility issues, servers SHOULD use the rfc1123-date
format, which requires a four-digit year.<a href="#section-4.1.1-13" class="pilcrow">¶</a></p>
<p id="section-4.1.1-14">NOTE: Some user agents store and process dates in cookies as 32-bit UNIX time_t
values. Implementation bugs in the libraries supporting time_t processing on
some systems might cause such user agents to process dates after the year 2038
incorrectly.<a href="#section-4.1.1-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sane-set-cookie-semantics">
<section id="section-4.1.2">
          <h4 id="name-semantics-non-normative">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-semantics-non-normative" class="section-name selfRef">Semantics (Non-Normative)</a>
          </h4>
<p id="section-4.1.2-1">This section describes simplified semantics of the <code>Set-Cookie</code> header field. These
semantics are detailed enough to be useful for understanding the most common
uses of cookies by servers. The full semantics are described in <a href="#ua-requirements" class="auto internal xref">Section 5</a>.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">When the user agent receives a <code>Set-Cookie</code> header field, the user agent stores the
cookie together with its attributes. Subsequently, when the user agent makes
an HTTP request, the user agent includes the applicable, non-expired cookies
in the <code>Cookie</code> header field.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">If the user agent receives a new cookie with the same cookie-name,
domain-value, and path-value as a cookie that it has already stored, the
existing cookie is evicted and replaced with the new cookie. Notice that
servers can delete cookies by sending the user agent a new cookie with an
Expires attribute with a value in the past.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">Unless the cookie's attributes indicate otherwise, the cookie is returned only
to the origin server (and not, for example, to any subdomains), and it expires
at the end of the current session (as defined by the user agent). User agents
ignore unrecognized cookie attributes (but not the entire cookie).<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<div id="attribute-expires">
<section id="section-4.1.2.1">
            <h5 id="name-the-expires-attribute">
<a href="#section-4.1.2.1" class="section-number selfRef">4.1.2.1. </a><a href="#name-the-expires-attribute" class="section-name selfRef">The Expires Attribute</a>
            </h5>
<p id="section-4.1.2.1-1">The Expires attribute indicates the maximum lifetime of the cookie,
represented as the date and time at which the cookie expires. The user agent is
not required to retain the cookie until the specified date has passed. In fact,
user agents often evict cookies due to memory pressure or privacy concerns.<a href="#section-4.1.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-max-age">
<section id="section-4.1.2.2">
            <h5 id="name-the-max-age-attribute">
<a href="#section-4.1.2.2" class="section-number selfRef">4.1.2.2. </a><a href="#name-the-max-age-attribute" class="section-name selfRef">The Max-Age Attribute</a>
            </h5>
<p id="section-4.1.2.2-1">The Max-Age attribute indicates the maximum lifetime of the cookie,
represented as the number of seconds until the cookie expires. The user agent is
not required to retain the cookie for the specified duration. In fact, user
agents often evict cookies due to memory pressure or privacy concerns.<a href="#section-4.1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.2-2">NOTE: Some existing user agents do not support the Max-Age attribute. User
agents that do not support the Max-Age attribute ignore the attribute.<a href="#section-4.1.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2.2-3">If a cookie has both the Max-Age and the Expires attribute, the Max-Age
attribute has precedence and controls the expiration date of the cookie. If a
cookie has neither the Max-Age nor the Expires attribute, the user agent
will retain the cookie until "the current session is over" (as defined by the
user agent).<a href="#section-4.1.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-domain">
<section id="section-4.1.2.3">
            <h5 id="name-the-domain-attribute">
<a href="#section-4.1.2.3" class="section-number selfRef">4.1.2.3. </a><a href="#name-the-domain-attribute" class="section-name selfRef">The Domain Attribute</a>
            </h5>
<p id="section-4.1.2.3-1">The Domain attribute specifies those hosts to which the cookie will be sent.<a href="#section-4.1.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.3-2">If the server includes the Domain attribute, the value applies to both the
specified domain and any subdomains. For example, if the value of the Domain
attribute is "site.example", the user agent will include the cookie in the
<code>Cookie</code> header field when making HTTP requests to site.example, www.site.example,
and www.corp.site.example. Note that a leading %x2E ("."), if present, is
ignored even though that character is not permitted.<a href="#section-4.1.2.3-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2.3-3">If the server omits the Domain attribute, the user agent will return the cookie
only to the origin server and not to any subdomains.<a href="#section-4.1.2.3-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2.3-4">WARNING: Some existing user agents treat an absent Domain attribute as if the
Domain attribute were present and contained the current host name. For
example, if site.example returns a <code>Set-Cookie</code> header field without a Domain
attribute, these user agents will erroneously send the cookie to
www.site.example and www.corp.site.example as well.<a href="#section-4.1.2.3-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2.3-5">The user agent will reject cookies unless the Domain attribute specifies a
scope for the cookie that would include the origin server. For example, the
user agent will accept a cookie with a Domain attribute of "site.example" or
of "foo.site.example" from foo.site.example, but the user agent will not accept
a cookie with a Domain attribute of "bar.site.example" or of
"baz.foo.site.example".<a href="#section-4.1.2.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-path">
<section id="section-4.1.2.4">
            <h5 id="name-the-path-attribute">
<a href="#section-4.1.2.4" class="section-number selfRef">4.1.2.4. </a><a href="#name-the-path-attribute" class="section-name selfRef">The Path Attribute</a>
            </h5>
<p id="section-4.1.2.4-1">The scope of each cookie is limited to a set of paths, controlled by the
Path attribute. If the server omits the Path attribute, the user agent will
use the "directory" of the request-uri's path component as the default value.
(See <a href="#cookie-path" class="auto internal xref">Section 5.3.3</a> for more details.)<a href="#section-4.1.2.4-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.4-2">The user agent will include the cookie in an HTTP request only if the path
portion of the request-uri matches (or is a subdirectory of) the cookie's
Path attribute, where the %x2F ("/") character is interpreted as a directory
separator.<a href="#section-4.1.2.4-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2.4-3">Although seemingly useful for isolating cookies between different paths within
a given host, the Path attribute cannot be relied upon for security (see
<a href="#security-considerations" class="auto internal xref">Section 8</a>).<a href="#section-4.1.2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-secure">
<section id="section-4.1.2.5">
            <h5 id="name-the-secure-attribute">
<a href="#section-4.1.2.5" class="section-number selfRef">4.1.2.5. </a><a href="#name-the-secure-attribute" class="section-name selfRef">The Secure Attribute</a>
            </h5>
<p id="section-4.1.2.5-1">The Secure attribute limits the scope of the cookie to "secure" channels
(where "secure" is outside the scope of this document). E.g., when a cookie has the Secure
attribute, the user agent will include the cookie in an HTTP request only if
the request is transmitted over a secure channel (typically HTTP over Transport
Layer Security (TLS) <span>[<a href="#RFC8446" class="cite xref">TLS13</a>]</span> <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span>).<a href="#section-4.1.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-httponly">
<section id="section-4.1.2.6">
            <h5 id="name-the-httponly-attribute">
<a href="#section-4.1.2.6" class="section-number selfRef">4.1.2.6. </a><a href="#name-the-httponly-attribute" class="section-name selfRef">The HttpOnly Attribute</a>
            </h5>
<p id="section-4.1.2.6-1">The HttpOnly attribute limits the scope of the cookie to HTTP requests. In
particular, the attribute instructs the user agent to omit the cookie when
providing access to cookies via non-HTTP APIs.<a href="#section-4.1.2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attribute-samesite">
<section id="section-4.1.2.7">
            <h5 id="name-the-samesite-attribute">
<a href="#section-4.1.2.7" class="section-number selfRef">4.1.2.7. </a><a href="#name-the-samesite-attribute" class="section-name selfRef">The SameSite Attribute</a>
            </h5>
<p id="section-4.1.2.7-1">The SameSite attribute limits the scope of the cookie upon creation and delivery
with respect to whether the cookie is considered to be "same-site" within a larger context
(where "same-site" is outside the scope of this document). The SameSite attribute is particularly
relevant for web browsers and web applications accessible through them.<a href="#section-4.1.2.7-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2.7-2">The SameSite attribute supports Strict, Lax, and None as values.<a href="#section-4.1.2.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="server-name-prefixes">
<section id="section-4.1.3">
          <h4 id="name-cookie-name-prefixes">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-cookie-name-prefixes" class="section-name selfRef">Cookie Name Prefixes</a>
          </h4>
<p id="section-4.1.3-1"><a href="#weak-confidentiality" class="auto internal xref">Section 8.5</a> and <a href="#weak-integrity" class="auto internal xref">Section 8.6</a> of this document spell out some of the drawbacks of cookies'
historical implementation. In particular, it is impossible for a server to have
confidence that a given cookie was set with a particular set of attributes. In
order to provide such confidence in a backwards-compatible way, two common sets
of requirements can be inferred from the first few characters of the cookie's
name.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2">To maximize compatibility with user agents, servers SHOULD use prefixes as
described below.<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
<div id="the-secure-prefix">
<section id="section-4.1.3.1">
            <h5 id="name-the-__secure-prefix">
<a href="#section-4.1.3.1" class="section-number selfRef">4.1.3.1. </a><a href="#name-the-__secure-prefix" class="section-name selfRef">The "__Secure-" Prefix</a>
            </h5>
<p id="section-4.1.3.1-1">If a cookie's name begins with a case-sensitive match for the string
<code>__Secure-</code>, then the cookie will have been set with a <code>Secure</code> attribute.<a href="#section-4.1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.1-2">For example, the following <code>Set-Cookie</code> header field would be rejected by a conformant
user agent, as it does not have a <code>Secure</code> attribute.<a href="#section-4.1.3.1-2" class="pilcrow">¶</a></p>
<div class="lang-example sourcecode" id="section-4.1.3.1-3">
<pre>
Set-Cookie: __Secure-SID=12345; Domain=site.example
</pre><a href="#section-4.1.3.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3.1-4">Whereas the following <code>Set-Cookie</code> header field would be accepted if set from a secure origin
(e.g. <code>https://site.example/</code>), and rejected otherwise:<a href="#section-4.1.3.1-4" class="pilcrow">¶</a></p>
<div class="lang-example sourcecode" id="section-4.1.3.1-5">
<pre>
Set-Cookie: __Secure-SID=12345; Domain=site.example; Secure
</pre><a href="#section-4.1.3.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-host-prefix">
<section id="section-4.1.3.2">
            <h5 id="name-the-__host-prefix">
<a href="#section-4.1.3.2" class="section-number selfRef">4.1.3.2. </a><a href="#name-the-__host-prefix" class="section-name selfRef">The "__Host-" Prefix</a>
            </h5>
<p id="section-4.1.3.2-1">If a cookie's name begins with a case-sensitive match for the string
<code>__Host-</code>, then the cookie will have been set with a <code>Secure</code> attribute, a
<code>Path</code> attribute with a value of <code>/</code>, and no <code>Domain</code> attribute.<a href="#section-4.1.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-2">This combination yields a cookie that hews as closely as a cookie can to
treating the origin as a security boundary. The lack of a <code>Domain</code> attribute
ensures that cookie's host-only is true, locking the cookie to a
particular host, rather than allowing it to span subdomains. Setting the <code>Path</code>
to <code>/</code> means that the cookie is effective for the entire host, and won't be
overridden for specific paths. The <code>Secure</code> attribute ensures that the cookie
is unaltered by non-secure origins, and won't span protocols.<a href="#section-4.1.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-3">Ports are the only piece of the same-origin policy that <code>__Host-</code> cookies continue
to ignore.<a href="#section-4.1.3.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.3.2-4">For example, the following cookies would always be rejected:<a href="#section-4.1.3.2-4" class="pilcrow">¶</a></p>
<div class="lang-example sourcecode" id="section-4.1.3.2-5">
<pre>
Set-Cookie: __Host-SID=12345
Set-Cookie: __Host-SID=12345; Secure
Set-Cookie: __Host-SID=12345; Domain=site.example
Set-Cookie: __Host-SID=12345; Domain=site.example; Path=/
Set-Cookie: __Host-SID=12345; Secure; Domain=site.example; Path=/
</pre><a href="#section-4.1.3.2-5" class="pilcrow">¶</a>
</div>
<p id="section-4.1.3.2-6">While the following would be accepted if set from a secure origin (e.g.
<code>https://site.example/</code>), and rejected otherwise:<a href="#section-4.1.3.2-6" class="pilcrow">¶</a></p>
<div class="lang-example sourcecode" id="section-4.1.3.2-7">
<pre>
Set-Cookie: __Host-SID=12345; Secure; Path=/
</pre><a href="#section-4.1.3.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-http-prefix">
<section id="section-4.1.3.3">
            <h5 id="name-the-__http-prefix">
<a href="#section-4.1.3.3" class="section-number selfRef">4.1.3.3. </a><a href="#name-the-__http-prefix" class="section-name selfRef">The "__Http-" Prefix</a>
            </h5>
<p id="section-4.1.3.3-1">If a cookie's name begins with a case-sensitive match for the string
<code>__Http-</code>, then the cookie will have been set with a <code>Secure</code> attribute, and an
<code>HttpOnly</code> attribute.<a href="#section-4.1.3.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.3-2">This helps developers and server operators to know that the cookie was set using
a <code>Set-Cookie</code> header, and is limited in scope to HTTP requests.<a href="#section-4.1.3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="the-hosthttp-prefix">
<section id="section-4.1.3.4">
            <h5 id="name-the-__hosthttp-prefix">
<a href="#section-4.1.3.4" class="section-number selfRef">4.1.3.4. </a><a href="#name-the-__hosthttp-prefix" class="section-name selfRef">The "__HostHttp-" prefix</a>
            </h5>
<p id="section-4.1.3.4-1">If a cookie's name begins with a case-sensitive match for the string
<code>__HostHttp-</code>, then the cookie will have been set with a <code>Secure</code> attribute, an
<code>HttpOnly</code> attribute, a <code>Path</code> attribute with a value of <code>/</code>, and no <code>Domain</code> attribute.<a href="#section-4.1.3.4-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3.4-2">This helps developers and server operators to know that the cookie was set using
a <code>Set-Cookie</code> header, and is limited in scope to HTTP requests.<a href="#section-4.1.3.4-2" class="pilcrow">¶</a></p>
<p id="section-4.1.3.4-3">This combination yields a cookie that hews as closely as a cookie can to
treating the origin as a security boundary, while at the same time ensuring developers
and server operators know that its scope is limited to HTTP requests. The lack of a
<code>Domain</code> attribute ensures that cookie's host-only is true, locking the cookie to a
particular host, rather than allowing it to span subdomains. Setting the <code>Path</code>
to <code>/</code> means that the cookie is effective for the entire host, and won't be
overridden for specific paths. The <code>Secure</code> attribute ensures that the cookie
is unaltered by non-secure origins, and won't span protocols. The <code>HttpOnly</code> attribute
ensures that the cookie is not exposed by the user agent to non-HTTP APIs.<a href="#section-4.1.3.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sane-cookie">
<section id="section-4.2">
        <h3 id="name-cookie">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-cookie" class="section-name selfRef">Cookie</a>
        </h3>
<div id="server-syntax">
<section id="section-4.2.1">
          <h4 id="name-syntax-2">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-syntax-2" class="section-name selfRef">Syntax</a>
          </h4>
<p id="section-4.2.1-1">The user agent sends stored cookies to the origin server in the <code>Cookie</code> header field.
If the server conforms to the requirements in <a href="#sane-set-cookie" class="auto internal xref">Section 4.1</a> (and the user agent
conforms to the requirements in <a href="#ua-requirements" class="auto internal xref">Section 5</a>), the user agent will send a <code>Cookie</code>
header field that conforms to the following grammar:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="lang-abnf sourcecode" id="section-4.2.1-2">
<pre>
cookie        = cookie-string
cookie-string = cookie-pair *( ";" SP cookie-pair )
</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-3">While <span><a href="https://rfc-editor.org/rfc/rfc9110#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> does not define a length limit for header
fields it is likely that the web server's implementation does impose a limit;
many popular implementations have default limits of 8 kibibytes. Servers SHOULD avoid
setting a large number of large cookies such that the final cookie-string
would exceed their header field limit. Not doing so could result in requests
to the server failing.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">Servers MUST be tolerant of multiple <code>Cookie</code> headers. For example, an HTTP/2
<span>[<a href="#RFC9113" class="cite xref">RFC9113</a>]</span> or HTTP/3 <span>[<a href="#RFC9114" class="cite xref">HTTP</a>]</span> client or intermediary might split a <code>Cookie</code>
header to improve compression. Servers are free to determine what form this
tolerance takes. For example, the server could process each <code>Cookie</code> header
individually or the server could concatenate all the <code>Cookie</code> headers into one
and then process that final, single, header. The server should be mindful of
any header field limits when deciding which approach to take.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-5">Note: Since intermediaries can modify <code>Cookie</code> headers they should also be
mindful of common server header field limits in order to avoid sending servers
headers that they cannot process. For example, concatenating multiple cookie
 headers into a single header might exceed a server's size limit.<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="semantics">
<section id="section-4.2.2">
          <h4 id="name-semantics">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-semantics" class="section-name selfRef">Semantics</a>
          </h4>
<p id="section-4.2.2-1">Each cookie-pair represents a cookie stored by the user agent. The
cookie-pair contains the cookie-name and cookie-value the user agent
received in the <code>Set-Cookie</code> header field.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">Notice that the cookie attributes are not returned. In particular, the server
cannot determine from the <code>Cookie</code>  field alone when a cookie will expire, for
which hosts the cookie is valid, for which paths the cookie is valid, or
whether the cookie was set with the Secure or HttpOnly attributes.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3">The semantics of individual cookies in the <code>Cookie</code> header field are not defined by
this document. Servers are expected to imbue these cookies with
application-specific semantics.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2-4">Although cookies are serialized linearly in the <code>Cookie</code> header field, servers SHOULD
NOT rely upon the serialization order. In particular, if the <code>Cookie</code> header field
contains two cookies with the same name (e.g., that were set with different
Path or Domain attributes), servers SHOULD NOT rely upon the order in which
these cookies appear in the header field.<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ua-requirements">
<section id="section-5">
      <h2 id="name-user-agent-requirements">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-user-agent-requirements" class="section-name selfRef">User Agent Requirements</a>
      </h2>
<p id="section-5-1">This section specifies the processing models associated with the <code>Cookie</code> and <code>Set-Cookie</code> header fields
in sufficient detail that a user agent can interoperate with existing servers (even those
that do not conform to the well-behaved profile described in <a href="#server-requirements" class="auto internal xref">Section 4</a>).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">A user agent could enforce more restrictions than those specified herein (e.g.,
restrictions specified by its cookie policy, described in <a href="#cookie-policy" class="auto internal xref">Section 7.2</a>).
However, such additional restrictions may reduce the likelihood that a user
agent will be able to interoperate with existing servers.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="cookie-concepts">
<section id="section-5.1">
        <h3 id="name-cookie-concepts">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-cookie-concepts" class="section-name selfRef">Cookie Concepts</a>
        </h3>
<p id="section-5.1-1">To facilitate the algorithms that follow, a number of pre-requisite concepts need to be introduced.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="cookie-store-and-limits">
<section id="section-5.1.1">
          <h4 id="name-cookie-store-and-limits">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-cookie-store-and-limits" class="section-name selfRef">Cookie Store And Limits</a>
          </h4>
<p id="section-5.1.1-1">A user agent has an associated <strong>cookie store</strong>, which is a list of cookies. It is initially « ».<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">A user agent has an associated <strong>total cookies-per-host limit</strong>, which is an integer. It SHOULD be 50 or more.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">A user agent has an associated <strong>total cookies limit</strong>, which is an integer. It SHOULD be 3000 or more.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">A user agent has an associated <strong>cookie age limit</strong>, which is a number of days. It SHOULD be 400 days or less (see <a href="#cookie-policy" class="auto internal xref">Section 7.2</a>).<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cookie-struct">
<section id="section-5.1.2">
          <h4 id="name-cookie-struct">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-cookie-struct" class="section-name selfRef">Cookie Struct</a>
          </h4>
<p id="section-5.1.2-1">A <strong>cookie</strong> is a struct that represents a piece of state to be transmitted between a client and a
server.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">A cookie's <strong>name</strong> is a byte sequence. It always needs to be set.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">A cookie's <strong>value</strong> is a byte sequence. It always needs to be set.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.1.2-4">A cookie's <strong>secure</strong> is a boolean. It is initially false.<a href="#section-5.1.2-4" class="pilcrow">¶</a></p>
<p id="section-5.1.2-5">A cookie's <strong>host</strong> is a domain, IP address, null, or failure. It is initially null. Note: Once a
cookie is in the user agent's cookie store its host is a domain or IP address.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
<p id="section-5.1.2-6">A cookie's <strong>host-only</strong> is a boolean. It is initially false.<a href="#section-5.1.2-6" class="pilcrow">¶</a></p>
<p id="section-5.1.2-7">A cookie's <strong>path</strong> is a URL path.<a href="#section-5.1.2-7" class="pilcrow">¶</a></p>
<p id="section-5.1.2-8">A cookie's <strong>has-path attribute</strong> is a boolean. It is initially false.<a href="#section-5.1.2-8" class="pilcrow">¶</a></p>
<p id="section-5.1.2-9">A cookie's <strong>same-site</strong> is "<code>strict</code>", "<code>lax</code>", "<code>unset</code>", or "<code>none</code>". It is initially "<code>unset</code>".<a href="#section-5.1.2-9" class="pilcrow">¶</a></p>
<p id="section-5.1.2-10">A cookie's <strong>http-only</strong> is a boolean. It is initially false.<a href="#section-5.1.2-10" class="pilcrow">¶</a></p>
<p id="section-5.1.2-11">A cookie's <strong>creation-time</strong> is a time. It is initially the current time.<a href="#section-5.1.2-11" class="pilcrow">¶</a></p>
<p id="section-5.1.2-12">A cookie's <strong>expiry-time</strong> is null or a time. It is initially null. Note: A prior version of this
specification referred to null with a distinct "persistent-flag" field being false.<a href="#section-5.1.2-12" class="pilcrow">¶</a></p>
<p id="section-5.1.2-13">A cookie's <strong>last-access-time</strong> is a time. It is initially the current time.<a href="#section-5.1.2-13" class="pilcrow">¶</a></p>
<div id="cookie-struct-miscellaneous">
<section id="section-5.1.2.1">
            <h5 id="name-cookie-struct-miscellaneous">
<a href="#section-5.1.2.1" class="section-number selfRef">5.1.2.1. </a><a href="#name-cookie-struct-miscellaneous" class="section-name selfRef">Cookie Struct Miscellaneous</a>
            </h5>
<p id="section-5.1.2.1-1">A cookie is <strong>expired</strong> if its expiry-time is non-null and its expiry-time is in the past.<a href="#section-5.1.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2.1-2">A cookie <em>cookie</em> is <strong>Host-prefix compatible</strong> if:<a href="#section-5.1.2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.2.1-3">
<li id="section-5.1.2.1-3.1">
                <p id="section-5.1.2.1-3.1.1"><em>cookie</em>'s secure is true;<a href="#section-5.1.2.1-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-5.1.2.1-3.2">
                <p id="section-5.1.2.1-3.2.1"><em>cookie</em>'s host-only is true;<a href="#section-5.1.2.1-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-5.1.2.1-3.3">
                <p id="section-5.1.2.1-3.3.1"><em>cookie</em>'s has-path attribute is true; and<a href="#section-5.1.2.1-3.3.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-5.1.2.1-3.4">
                <p id="section-5.1.2.1-3.4.1"><em>cookie</em>'s path's size is 1 and <em>cookie</em>'s path[0] is the empty string,<a href="#section-5.1.2.1-3.4.1" class="pilcrow">¶</a></p>
</li>
            </ol>
<p id="section-5.1.2.1-4">A cookie <em>cookie</em> is <strong>Http-prefix compatible</strong> if:<a href="#section-5.1.2.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.2.1-5">
<li id="section-5.1.2.1-5.1">
                <p id="section-5.1.2.1-5.1.1"><em>cookie</em>'s secure is true; and<a href="#section-5.1.2.1-5.1.1" class="pilcrow">¶</a></p>
</li>
              <li id="section-5.1.2.1-5.2">
                <p id="section-5.1.2.1-5.2.1"><em>cookie</em>'s http-only is false,<a href="#section-5.1.2.1-5.2.1" class="pilcrow">¶</a></p>
</li>
            </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="cookie-store-eviction">
<section id="section-5.2">
        <h3 id="name-cookie-store-eviction">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-cookie-store-eviction" class="section-name selfRef">Cookie Store Eviction</a>
        </h3>
<div id="remove-expired-cookies">
<section id="section-5.2.1">
          <h4 id="name-remove-expired-cookies">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-remove-expired-cookies" class="section-name selfRef">Remove Expired Cookies</a>
          </h4>
<ol start="1" type="1" class="normal type-1" id="section-5.2.1-1">
<li id="section-5.2.1-1.1">
              <p id="section-5.2.1-1.1.1">Let <em>expiredCookies</em> be a list of references to all expired cookies in the user agent's cookie store.<a href="#section-5.2.1-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.1-1.2">
              <p id="section-5.2.1-1.2.1">For each <em>cookie</em> of <em>expiredCookies</em>:<a href="#section-5.2.1-1.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.1-1.2.2">
<li id="section-5.2.1-1.2.2.1">
                  <p id="section-5.2.1-1.2.2.1.1">Remove <em>cookie</em> from the user agent's cookie store.<a href="#section-5.2.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-5.2.1-1.3">
              <p id="section-5.2.1-1.3.1">Return <em>expiredCookies</em>.<a href="#section-5.2.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="remove-excess-cookies-for-a-host">
<section id="section-5.2.2">
          <h4 id="name-remove-excess-cookies-for-a">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-remove-excess-cookies-for-a" class="section-name selfRef">Remove Excess Cookies for a Host</a>
          </h4>
<p id="section-5.2.2-1">To <strong>Remove Excess Cookies for a Host</strong> given a host <em>host</em>:<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.2-2">
<li id="section-5.2.2-2.1">
              <p id="section-5.2.2-2.1.1">Let <em>insecureCookies</em> be a list of references to all cookies in the user agent's cookie store whose host is host-equal
to <em>host</em> and whose secure is false.<a href="#section-5.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.2-2.2">
              <p id="section-5.2.2-2.2.1">Sort <em>insecureCookies</em> by earliest last-access-time first.<a href="#section-5.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.2-2.3">
              <p id="section-5.2.2-2.3.1">Let <em>secureCookies</em> be a list of references to all cookies in the user agent's cookie store whose host is host-equal
to <em>host</em> and whose secure is true.<a href="#section-5.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.2-2.4">
              <p id="section-5.2.2-2.4.1">Sort <em>secureCookies</em> by earliest last-access-time first.<a href="#section-5.2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.2-2.5">
              <p id="section-5.2.2-2.5.1">Let <em>excessHostCookies</em> be an empty list of cookies.<a href="#section-5.2.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.2-2.6">
              <p id="section-5.2.2-2.6.1">While <em>insecureCookies</em>'s size + <em>secureCookies</em>'s size is greater than the user agent's total cookies-per-host limit:<a href="#section-5.2.2-2.6.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.2-2.6.2">
<li id="section-5.2.2-2.6.2.1">
                  <p id="section-5.2.2-2.6.2.1.1">If <em>insecureCookies</em> is not empty:<a href="#section-5.2.2-2.6.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.2-2.6.2.1.2">
<li id="section-5.2.2-2.6.2.1.2.1">
                      <p id="section-5.2.2-2.6.2.1.2.1.1">Let <em>cookie</em> be the first item of <em>insecureCookies</em>.<a href="#section-5.2.2-2.6.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.2.2-2.6.2.1.2.2">
                      <p id="section-5.2.2-2.6.2.1.2.2.1">Remove <em>cookie</em> from <em>insecureCookies</em>.<a href="#section-5.2.2-2.6.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.2.2-2.6.2.1.2.3">
                      <p id="section-5.2.2-2.6.2.1.2.3.1">Remove <em>cookie</em> from the user agent's cookie store.<a href="#section-5.2.2-2.6.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.2.2-2.6.2.1.2.4">
                      <p id="section-5.2.2-2.6.2.1.2.4.1">Append <em>cookie</em> to <em>excessHostCookies</em>.<a href="#section-5.2.2-2.6.2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
                <li id="section-5.2.2-2.6.2.2">
                  <p id="section-5.2.2-2.6.2.2.1">Otherwise:<a href="#section-5.2.2-2.6.2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.2-2.6.2.2.2">
<li id="section-5.2.2-2.6.2.2.2.1">
                      <p id="section-5.2.2-2.6.2.2.2.1.1">Let <em>cookie</em> be the first item of <em>secureCookies</em>.<a href="#section-5.2.2-2.6.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.2.2-2.6.2.2.2.2">
                      <p id="section-5.2.2-2.6.2.2.2.2.1">Remove <em>cookie</em> from <em>secureCookies</em>.<a href="#section-5.2.2-2.6.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.2.2-2.6.2.2.2.3">
                      <p id="section-5.2.2-2.6.2.2.2.3.1">Remove <em>cookie</em> from the user agent's cookie store.<a href="#section-5.2.2-2.6.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.2.2-2.6.2.2.2.4">
                      <p id="section-5.2.2-2.6.2.2.2.4.1">Append <em>cookie</em> to <em>excessHostCookies</em>.<a href="#section-5.2.2-2.6.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
              </ol>
</li>
            <li id="section-5.2.2-2.7">
              <p id="section-5.2.2-2.7.1">Return <em>excessHostCookies</em>.<a href="#section-5.2.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="remove-global-excess-cookies">
<section id="section-5.2.3">
          <h4 id="name-remove-global-excess-cookie">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-remove-global-excess-cookie" class="section-name selfRef">Remove Global Excess Cookies</a>
          </h4>
<p id="section-5.2.3-1">To <strong>Remove Global Excess Cookies</strong>:<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.3-2">
<li id="section-5.2.3-2.1">
              <p id="section-5.2.3-2.1.1">Let <em>allCookies</em> be the result of sorting the user agent's cookie store by earliest last-access-time first.<a href="#section-5.2.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.3-2.2">
              <p id="section-5.2.3-2.2.1">Let <em>excessGlobalCookies</em> be an empty list of cookies.<a href="#section-5.2.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.2.3-2.3">
              <p id="section-5.2.3-2.3.1">While <em>allCookies</em>'s size is greater than the user agent's total cookies limit:<a href="#section-5.2.3-2.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.3-2.3.2">
<li id="section-5.2.3-2.3.2.1">
                  <p id="section-5.2.3-2.3.2.1.1">Let <em>cookie</em> be the first item of <em>allCookies</em>.<a href="#section-5.2.3-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.2.3-2.3.2.2">
                  <p id="section-5.2.3-2.3.2.2.1">Remove <em>cookie</em> from <em>allCookies</em>.<a href="#section-5.2.3-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.2.3-2.3.2.3">
                  <p id="section-5.2.3-2.3.2.3.1">Remove <em>cookie</em> from the user agent's cookie store.<a href="#section-5.2.3-2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.2.3-2.3.2.4">
                  <p id="section-5.2.3-2.3.2.4.1">Append <em>cookie</em> to <em>excessGlobalCookies</em>.<a href="#section-5.2.3-2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-5.2.3-2.4">
              <p id="section-5.2.3-2.4.1">Return <em>excessGlobalCookies</em>.<a href="#section-5.2.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="subcomponent-algorithms">
<section id="section-5.3">
        <h3 id="name-subcomponent-algorithms">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-subcomponent-algorithms" class="section-name selfRef">Subcomponent Algorithms</a>
        </h3>
<p id="section-5.3-1">This section defines some algorithms used by user agents to process specific
subcomponents of the <code>Cookie</code> and <code>Set-Cookie</code> header fields.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<div id="cookie-date">
<section id="section-5.3.1">
          <h4 id="name-parse-a-date">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-parse-a-date" class="section-name selfRef">Parse a Date</a>
          </h4>
<p id="section-5.3.1-1">To <strong>Parse a Date</strong> given a byte sequence <em>input</em>, run these steps. They return a date and time or failure.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2">Note that the various boolean flags defined as a part
of the algorithm (i.e., found-time, found-day-of-month, found-month,
found-year) are initially "not set".<a href="#section-5.3.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3.1-3">
<li id="section-5.3.1-3.1">
              <p id="section-5.3.1-3.1.1">Using the grammar below, divide the cookie-date into date-tokens.<a href="#section-5.3.1-3.1.1" class="pilcrow">¶</a></p>
<div class="lang-abnf sourcecode" id="section-5.3.1-3.1.2">
<pre>
cookie-date     = *delimiter date-token-list *delimiter
date-token-list = date-token *( 1*delimiter date-token )
date-token      = 1*non-delimiter

delimiter       = %x09 / %x20-2F / %x3B-40 / %x5B-60 / %x7B-7E
non-delimiter   = %x00-08 / %x0A-1F / DIGIT / ":" / ALPHA
                  / %x7F-FF
non-digit       = %x00-2F / %x3A-FF

day-of-month    = 1*2DIGIT [ non-digit *OCTET ]
month           = ( "jan" / "feb" / "mar" / "apr" /
                    "may" / "jun" / "jul" / "aug" /
                    "sep" / "oct" / "nov" / "dec" ) *OCTET
year            = 2*4DIGIT [ non-digit *OCTET ]
time            = hms-time [ non-digit *OCTET ]
hms-time        = time-field ":" time-field ":" time-field
time-field      = 1*2DIGIT
</pre><a href="#section-5.3.1-3.1.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="section-5.3.1-3.2">
              <p id="section-5.3.1-3.2.1">Process each date-token sequentially in the order the date-tokens
appear in the cookie-date:<a href="#section-5.3.1-3.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3.1-3.2.2">
<li id="section-5.3.1-3.2.2.1">
                  <p id="section-5.3.1-3.2.2.1.1">If the found-time flag is not set and the token matches the
 time production, set the found-time flag and set the hour-value,
 minute-value, and second-value to the numbers denoted by the digits
 in the date-token, respectively. Skip the remaining sub-steps and
 continue to the next date-token.<a href="#section-5.3.1-3.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.3.1-3.2.2.2">
                  <p id="section-5.3.1-3.2.2.2.1">If the found-day-of-month flag is not set and the date-token matches
 the day-of-month production, set the found-day-of-month flag and set
 the day-of-month-value to the number denoted by the date-token. Skip
 the remaining sub-steps and continue to the next date-token.<a href="#section-5.3.1-3.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.3.1-3.2.2.3">
                  <p id="section-5.3.1-3.2.2.3.1">If the found-month flag is not set and the date-token matches the
 month production, set the found-month flag and set the month-value
 to the month denoted by the date-token. Skip the remaining sub-steps
 and continue to the next date-token.<a href="#section-5.3.1-3.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.3.1-3.2.2.4">
                  <p id="section-5.3.1-3.2.2.4.1">If the found-year flag is not set and the date-token matches the
 year production, set the found-year flag and set the year-value to
 the number denoted by the date-token. Skip the remaining sub-steps
 and continue to the next date-token.<a href="#section-5.3.1-3.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-5.3.1-3.3">
              <p id="section-5.3.1-3.3.1">If the year-value is greater than or equal to 70 and less than or equal to
99, increment the year-value by 1900.<a href="#section-5.3.1-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.3.1-3.4">
              <p id="section-5.3.1-3.4.1">If the year-value is greater than or equal to 0 and less than or equal to
69, increment the year-value by 2000.<a href="#section-5.3.1-3.4.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3.1-3.4.2">
<li id="section-5.3.1-3.4.2.1">
                  <p id="section-5.3.1-3.4.2.1.1">NOTE: Some existing user agents interpret two-digit years differently.<a href="#section-5.3.1-3.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-5.3.1-3.5">
              <p id="section-5.3.1-3.5.1">If one of the following is true:<a href="#section-5.3.1-3.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1-3.5.2.1">
                  <p id="section-5.3.1-3.5.2.1.1">at least one of the found-day-of-month, found-month, found-year, or
found-time flags is not set,<a href="#section-5.3.1-3.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.1-3.5.2.2">
                  <p id="section-5.3.1-3.5.2.2.1">the day-of-month-value is less than 1 or greater than 31,<a href="#section-5.3.1-3.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.1-3.5.2.3">
                  <p id="section-5.3.1-3.5.2.3.1">the year-value is less than 1601,<a href="#section-5.3.1-3.5.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.1-3.5.2.4">
                  <p id="section-5.3.1-3.5.2.4.1">the hour-value is greater than 23,<a href="#section-5.3.1-3.5.2.4.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.1-3.5.2.5">
                  <p id="section-5.3.1-3.5.2.5.1">the minute-value is greater than 59, or<a href="#section-5.3.1-3.5.2.5.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.1-3.5.2.6">
                  <p id="section-5.3.1-3.5.2.6.1">the second-value is greater than 59,<a href="#section-5.3.1-3.5.2.6.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-5.3.1-3.5.3">
then return failure.<a href="#section-5.3.1-3.5.3" class="pilcrow">¶</a></p>
<p id="section-5.3.1-3.5.4">
(Note that leap seconds cannot be represented in this syntax.)<a href="#section-5.3.1-3.5.4" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.3.1-3.6">
              <p id="section-5.3.1-3.6.1">Let the parsed-cookie-date be the date whose day-of-month, month,
year, hour, minute, and second (in UTC) are the
day-of-month-value, the month-value, the year-value, the hour-value,
the minute-value, and the second-value, respectively. If no such date
exists, abort these steps and fail to parse the cookie-date.<a href="#section-5.3.1-3.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.3.1-3.7">
              <p id="section-5.3.1-3.7.1">Return the parsed-cookie-date as the result of this algorithm.<a href="#section-5.3.1-3.7.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="domain-matching">
<section id="section-5.3.2">
          <h4 id="name-domain-matching">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-domain-matching" class="section-name selfRef">Domain Matching</a>
          </h4>
<p id="section-5.3.2-1">A host <em>host</em> <strong>Domain-Matches</strong> a string <em>domainAttributeValue</em> if at least one of the following is true:<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-2.1">
              <p id="section-5.3.2-2.1.1"><em>host</em> equals <em>domainAttributeValue</em>, or<a href="#section-5.3.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.2-2.2">
              <p id="section-5.3.2-2.2.1">if all of the following are true:<a href="#section-5.3.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2-2.2.2.1">
                  <p id="section-5.3.2-2.2.2.1.1"><em>host</em> is a domain, and<a href="#section-5.3.2-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.3.2-2.2.2.2">
                  <p id="section-5.3.2-2.2.2.2.1"><em>host</em> ends with the concatenation of U+002E (.) and <em>domainAttributeValue</em>.<a href="#section-5.3.2-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
</section>
</div>
<div id="cookie-path">
<section id="section-5.3.3">
          <h4 id="name-cookie-default-path">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-cookie-default-path" class="section-name selfRef">Cookie Default Path</a>
          </h4>
<p id="section-5.3.3-1">To determine the <strong>Cookie Default Path</strong>, given a URL path <em>path</em>, run these steps.
They return a URL path.<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3.3-2">
<li id="section-5.3.3-2.1">
              <p id="section-5.3.3-2.1.1">Assert: <em>path</em> is a non-empty list.<a href="#section-5.3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.3.3-2.2">
              <p id="section-5.3.3-2.2.1">If <em>path</em>'s size is greater than 1, then remove <em>path</em>'s last item.<a href="#section-5.3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.3.3-2.3">
              <p id="section-5.3.3-2.3.1">Otherwise, set <em>path</em>[0] to the empty string.<a href="#section-5.3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.3.3-2.4">
              <p id="section-5.3.3-2.4.1">Return <em>path</em>.<a href="#section-5.3.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="path-matching">
<section id="section-5.3.4">
          <h4 id="name-path-matching">
<a href="#section-5.3.4" class="section-number selfRef">5.3.4. </a><a href="#name-path-matching" class="section-name selfRef">Path Matching</a>
          </h4>
<p id="section-5.3.4-1">To determine if a URL path <em>requestPath</em> <strong>Path-Matches</strong> a URL path <em>cookiePath</em>, run these steps.
They return a boolean.<a href="#section-5.3.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3.4-2">
<li id="section-5.3.4-2.1">
              <p id="section-5.3.4-2.1.1">Let <em>serializedRequestPath</em> be the result of URL path serializing <em>requestPath</em>.<a href="#section-5.3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.3.4-2.2">
              <p id="section-5.3.4-2.2.1">Let <em>serializedCookiePath</em> be the result of URL path serializing <em>cookiePath</em>.<a href="#section-5.3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.3.4-2.3">
              <p id="section-5.3.4-2.3.1">If <em>serializedCookiePath</em> is <em>serializedRequestPath</em>, then return true.<a href="#section-5.3.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.3.4-2.4">
              <p id="section-5.3.4-2.4.1">If <em>serializedRequestPath</em> starts with <em>serializedCookiePath</em> and <em>serializedCookiePath</em> ends
with a U+002F (/), then return true.<a href="#section-5.3.4-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.3.4-2.5">
              <p id="section-5.3.4-2.5.1">Return whether the concatenation of <em>serializedRequestPath</em> followed by U+002F (/) starts with <em>serializedCookiePath</em>.<a href="#section-5.3.4-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="main-algorithms">
<section id="section-5.4">
        <h3 id="name-main-algorithms">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-main-algorithms" class="section-name selfRef">Main Algorithms</a>
        </h3>
<div id="parse-and-store-a-cookie">
<section id="section-5.4.1">
          <h4 id="name-parse-and-store-a-cookie">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-parse-and-store-a-cookie" class="section-name selfRef">Parse and Store a Cookie</a>
          </h4>
<p id="section-5.4.1-1">To <strong>Parse and Store a Cookie</strong> given a byte sequence <em>input</em>, boolean <em>isSecure</em>, domain or IP address <em>host</em>,
URL path <em>path</em>, boolean <em>httpOnlyAllowed</em>, boolean <em>allowNonHostOnlyCookieForPublicSuffix</em>, and boolean <em>sameSiteStrictOrLaxAllowed</em>:<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.1-2">
<li id="section-5.4.1-2.1">
              <p id="section-5.4.1-2.1.1">Let <em>cookie</em> be the result of running Parse a Cookie with <em>input</em>, <em>isSecure</em>, <em>host</em>, and <em>path</em>.<a href="#section-5.4.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.1-2.2">
              <p id="section-5.4.1-2.2.1">If <em>cookie</em> is failure, then return.<a href="#section-5.4.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.1-2.3">
              <p id="section-5.4.1-2.3.1">Return the result of Store a Cookie given <em>cookie</em>, <em>isSecure</em>, <em>host</em>, <em>path</em>, <em>httpOnlyAllowed</em>,
<em>allowNonHostOnlyCookieForPublicSuffix</em>, and <em>sameSiteStrictOrLaxAllowed</em>.<a href="#section-5.4.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="parse-a-cookie">
<section id="section-5.4.2">
          <h4 id="name-parse-a-cookie">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-parse-a-cookie" class="section-name selfRef">Parse a Cookie</a>
          </h4>
<p id="section-5.4.2-1">To <strong>Parse a Cookie</strong> given a byte sequence <em>input</em>, boolean <em>isSecure</em>, host <em>host</em>,
URL path <em>path</em>, run these steps. They return a new cookie or failure:<a href="#section-5.4.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2">
<li id="section-5.4.2-2.1">
              <p id="section-5.4.2-2.1.1">If <em>input</em> contains a byte in the range 0x00 to 0x08, inclusive,
the range 0x0A to 0x1F inclusive, or 0x7F (CTL bytes excluding HTAB),
then return failure.<a href="#section-5.4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.2">
              <p id="section-5.4.2-2.2.1">Let <em>nameValueInput</em> be null.<a href="#section-5.4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.3">
              <p id="section-5.4.2-2.3.1">Let <em>attributesInput</em> be the empty byte sequence.<a href="#section-5.4.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.4">
              <p id="section-5.4.2-2.4.1">If <em>input</em> contains 0x3B (;), then set <em>nameValueInput</em> to the bytes up to, but not including,
the first 0x3B (;), and <em>attributesInput</em> to the remainder of <em>input</em> (including the 0x3B (;) in question).<a href="#section-5.4.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.5">
              <p id="section-5.4.2-2.5.1">Otherwise, set <em>nameValueInput</em> to <em>input</em>.<a href="#section-5.4.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.6">
              <p id="section-5.4.2-2.6.1">Assert: <em>nameValueInput</em> is a byte sequence.<a href="#section-5.4.2-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.7">
              <p id="section-5.4.2-2.7.1">Let <em>name</em> be null.<a href="#section-5.4.2-2.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.8">
              <p id="section-5.4.2-2.8.1">Let <em>value</em> be null.<a href="#section-5.4.2-2.8.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.9">
              <p id="section-5.4.2-2.9.1">If <em>nameValueInput</em> does not contain a 0x3D (=) character, then set <em>name</em>
to the empty byte sequence, and <em>value</em> to <em>nameValueInput</em>.<a href="#section-5.4.2-2.9.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.10">
              <p id="section-5.4.2-2.10.1">Otherwise, set <em>name</em> to the bytes up to, but not
including, the first 0x3D (=), and set <em>value</em>
to the bytes after the first 0x3D (=) (possibly being the
empty byte sequence).<a href="#section-5.4.2-2.10.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.11">
              <p id="section-5.4.2-2.11.1">Remove any leading or trailing WSP bytes from <em>name</em> and <em>value</em>.<a href="#section-5.4.2-2.11.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.12">
              <p id="section-5.4.2-2.12.1">If <em>name</em>'s length + <em>value</em>'s length is 0 or is greater than 4096, then return failure.<a href="#section-5.4.2-2.12.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.13">
              <p id="section-5.4.2-2.13.1">Let <em>cookie</em> be a new cookie whose name is <em>name</em> and value is <em>value</em>.<a href="#section-5.4.2-2.13.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.14">
              <p id="section-5.4.2-2.14.1">Set <em>cookie</em>'s path to the result of running Cookie Default Path with <em>path</em>.<a href="#section-5.4.2-2.14.1" class="pilcrow">¶</a></p>
<p id="section-5.4.2-2.14.2">
Note: A <code>Path</code> attribute can override this.<a href="#section-5.4.2-2.14.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.2-2.15">
              <p id="section-5.4.2-2.15.1">While <em>attributesInput</em> is not an empty byte sequence:<a href="#section-5.4.2-2.15.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2.15.2">
<li id="section-5.4.2-2.15.2.1">
                  <p id="section-5.4.2-2.15.2.1.1">Let <em>maxAgeSeen</em> be false.<a href="#section-5.4.2-2.15.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.2">
                  <p id="section-5.4.2-2.15.2.2.1">Let <em>char</em> be the result of consuming the first byte of <em>attributesInput</em>.<a href="#section-5.4.2-2.15.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.3">
                  <p id="section-5.4.2-2.15.2.3.1">Assert: <em>char</em> is 0x3B (;).<a href="#section-5.4.2-2.15.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.4">
                  <p id="section-5.4.2-2.15.2.4.1">Let <em>attributeNameValueInput</em> be null.<a href="#section-5.4.2-2.15.2.4.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.5">
                  <p id="section-5.4.2-2.15.2.5.1">If <em>attributesInput</em> contains 0x3B (;), then
set <em>attributeNameValueInput</em> to the result of consuming the bytes of
<em>attributesInput</em> up to, but not including, the first 0x3B (;).<a href="#section-5.4.2-2.15.2.5.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.6">
                  <p id="section-5.4.2-2.15.2.6.1">Otherwise, set <em>attributeNameValueInput</em> to the result of consuming the remainder of <em>attributesInput</em>.<a href="#section-5.4.2-2.15.2.6.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.7">
                  <p id="section-5.4.2-2.15.2.7.1">Let <em>attributeName</em> be null.<a href="#section-5.4.2-2.15.2.7.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.8">
                  <p id="section-5.4.2-2.15.2.8.1">Let <em>attributeValue</em> be the empty string.<a href="#section-5.4.2-2.15.2.8.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.9">
                  <p id="section-5.4.2-2.15.2.9.1">If <em>attributeNameValueInput</em> contains a 0x3D (=), then set <em>attributeName</em> to the bytes
up to, but not including, the first 0x3D (=) of <em>attributeNameValueInput</em>, and <em>attributeValue</em> to the bytes
after the first 0x3D (=) of <em>attributeNameValueInput</em>.<a href="#section-5.4.2-2.15.2.9.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.10">
                  <p id="section-5.4.2-2.15.2.10.1">Otherwise, set <em>attributeName</em> to <em>attributeNameValueInput</em>.<a href="#section-5.4.2-2.15.2.10.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.11">
                  <p id="section-5.4.2-2.15.2.11.1">Remove any leading or trailing WSP bytes from <em>attributeName</em> and <em>attributeValue</em>.<a href="#section-5.4.2-2.15.2.11.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.12">
                  <p id="section-5.4.2-2.15.2.12.1">If <em>attributeValue</em>'s length is greater than 1024, then continue.<a href="#section-5.4.2-2.15.2.12.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.2-2.15.2.13">
                  <p id="section-5.4.2-2.15.2.13.1">If <em>attributeName</em> is a byte-case-insensitive match for <code>Expires</code>:<a href="#section-5.4.2-2.15.2.13.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2.15.2.13.2">
<li id="section-5.4.2-2.15.2.13.2.1">
                      <p id="section-5.4.2-2.15.2.13.2.1.1">If <em>maxAgeSeen</em> is true, then continue.<a href="#section-5.4.2-2.15.2.13.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.13.2.2">
                      <p id="section-5.4.2-2.15.2.13.2.2.1">Let <em>expiryTime</em> be the result of running Parse a Date given <em>attributeValue</em>.<a href="#section-5.4.2-2.15.2.13.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.13.2.3">
                      <p id="section-5.4.2-2.15.2.13.2.3.1">If <em>attributeValue</em> is failure, then continue.<a href="#section-5.4.2-2.15.2.13.2.3.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.13.2.4">
                      <p id="section-5.4.2-2.15.2.13.2.4.1">If <em>expiryTime</em> is greater than the current time and date + the user agent's cookie age limit,
then set <em>expiryTime</em> to the user agent's cookie age limit.<a href="#section-5.4.2-2.15.2.13.2.4.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.13.2.5">
                      <p id="section-5.4.2-2.15.2.13.2.5.1">If <em>expiryTime</em> is earlier than the earliest date the user agent can
represent, the user agent MAY replace <em>expiryTime</em> with the earliest
representable date.<a href="#section-5.4.2-2.15.2.13.2.5.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.13.2.6">
                      <p id="section-5.4.2-2.15.2.13.2.6.1">Set <em>cookie</em>'s expiry-time to <em>expiryTime</em>.<a href="#section-5.4.2-2.15.2.13.2.6.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
                <li id="section-5.4.2-2.15.2.14">
                  <p id="section-5.4.2-2.15.2.14.1">If <em>attributeName</em> is a byte-case-insensitive match for <code>Max-Age</code>:<a href="#section-5.4.2-2.15.2.14.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2.15.2.14.2">
<li id="section-5.4.2-2.15.2.14.2.1">
                      <p id="section-5.4.2-2.15.2.14.2.1.1">If <em>attributeValue</em> is empty, continue.<a href="#section-5.4.2-2.15.2.14.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.14.2.2">
                      <p id="section-5.4.2-2.15.2.14.2.2.1">If the first byte of <em>attributeValue</em> is neither a DIGIT, nor 0x2D (-)
followed by a DIGIT, then continue.<a href="#section-5.4.2-2.15.2.14.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.14.2.3">
                      <p id="section-5.4.2-2.15.2.14.2.3.1">If the remainder of <em>attributeValue</em> contains a non-DIGIT, then continue.<a href="#section-5.4.2-2.15.2.14.2.3.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.14.2.4">
                      <p id="section-5.4.2-2.15.2.14.2.4.1">Let <em>deltaSeconds</em> be <em>attributeValue</em>, converted to a base 10 integer.<a href="#section-5.4.2-2.15.2.14.2.4.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.14.2.5">
                      <p id="section-5.4.2-2.15.2.14.2.5.1">Set <em>deltaSeconds</em> to the smaller of <em>deltaSeconds</em> and the user agent's cookie age limit, in seconds.<a href="#section-5.4.2-2.15.2.14.2.5.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.14.2.6">
                      <p id="section-5.4.2-2.15.2.14.2.6.1">If <em>deltaSeconds</em> is less than or equal to 0, let <em>expiryTime</em> be
the earliest representable date and time. Otherwise, let <em>expiryTime</em>
be the current date and time + <em>deltaSeconds</em> seconds.<a href="#section-5.4.2-2.15.2.14.2.6.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.14.2.7">
                      <p id="section-5.4.2-2.15.2.14.2.7.1">Set <em>cookie</em>'s expiry-time to <em>expiryTime</em>.<a href="#section-5.4.2-2.15.2.14.2.7.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.14.2.8">
                      <p id="section-5.4.2-2.15.2.14.2.8.1">Set <em>maxAgeSeen</em> to true.<a href="#section-5.4.2-2.15.2.14.2.8.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
                <li id="section-5.4.2-2.15.2.15">
                  <p id="section-5.4.2-2.15.2.15.1">If <em>attributeName</em> is a byte-case-insensitive match for <code>Domain</code>:<a href="#section-5.4.2-2.15.2.15.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2.15.2.15.2">
<li id="section-5.4.2-2.15.2.15.2.1">
                      <p id="section-5.4.2-2.15.2.15.2.1.1">Let <em>host</em> be failure.<a href="#section-5.4.2-2.15.2.15.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.15.2.2">
                      <p id="section-5.4.2-2.15.2.15.2.2.1">If <em>attributeValue</em> contains only ASCII bytes:<a href="#section-5.4.2-2.15.2.15.2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2.15.2.15.2.2.2">
<li id="section-5.4.2-2.15.2.15.2.2.2.1">
                          <p id="section-5.4.2-2.15.2.15.2.2.2.1.1">Let <em>hostInput</em> be <em>attributeValue</em>, ASCII decoded.<a href="#section-5.4.2-2.15.2.15.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                        <li id="section-5.4.2-2.15.2.15.2.2.2.2">
                          <p id="section-5.4.2-2.15.2.15.2.2.2.2.1">If <em>hostInput</em> starts with U+002E (.), then set <em>hostInput</em> to <em>hostInput</em>
without its leading U+002E (.).<a href="#section-5.4.2-2.15.2.15.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                        <li id="section-5.4.2-2.15.2.15.2.2.2.3">
                          <p id="section-5.4.2-2.15.2.15.2.2.2.3.1">Set <em>host</em> to the result of host parsing <em>hostInput</em>.<a href="#section-5.4.2-2.15.2.15.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                      </ol>
</li>
                    <li id="section-5.4.2-2.15.2.15.2.3">
                      <p id="section-5.4.2-2.15.2.15.2.3.1">Set <em>cookie</em>'s host to <em>host</em>.<a href="#section-5.4.2-2.15.2.15.2.3.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
                <li id="section-5.4.2-2.15.2.16">
                  <p id="section-5.4.2-2.15.2.16.1">If <em>attributeName</em> is a byte-case-insensitive match for <code>Path</code>:<a href="#section-5.4.2-2.15.2.16.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2.15.2.16.2">
<li id="section-5.4.2-2.15.2.16.2.1">
                      <p id="section-5.4.2-2.15.2.16.2.1.1">If <em>attributeValue</em> is not empty and if the first byte of
<em>attributeValue</em> is 0x2F (/), then:<a href="#section-5.4.2-2.15.2.16.2.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2.15.2.16.2.1.2">
<li id="section-5.4.2-2.15.2.16.2.1.2.1">
                          <p id="section-5.4.2-2.15.2.16.2.1.2.1.1">Set <em>cookie</em>'s path to <em>attributeValue</em> split on 0x2F (/).<a href="#section-5.4.2-2.15.2.16.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                        <li id="section-5.4.2-2.15.2.16.2.1.2.2">
                          <p id="section-5.4.2-2.15.2.16.2.1.2.2.1">Set <em>cookie</em>'s has-path attribute to true.<a href="#section-5.4.2-2.15.2.16.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                      </ol>
</li>
                  </ol>
</li>
                <li id="section-5.4.2-2.15.2.17">
                  <p id="section-5.4.2-2.15.2.17.1">If <em>attributeName</em> is a byte-case-insensitive match for <code>Secure</code>:<a href="#section-5.4.2-2.15.2.17.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2.15.2.17.2">
<li id="section-5.4.2-2.15.2.17.2.1">
                      <p id="section-5.4.2-2.15.2.17.2.1.1">Set <em>cookie</em>'s secure to true.<a href="#section-5.4.2-2.15.2.17.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
                <li id="section-5.4.2-2.15.2.18">
                  <p id="section-5.4.2-2.15.2.18.1">If <em>attributeName</em> is a byte-case-insensitive match for <code>HttpOnly</code>:<a href="#section-5.4.2-2.15.2.18.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2.15.2.18.2">
<li id="section-5.4.2-2.15.2.18.2.1">
                      <p id="section-5.4.2-2.15.2.18.2.1.1">Set <em>cookie</em>'s http-only to true.<a href="#section-5.4.2-2.15.2.18.2.1.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
                <li id="section-5.4.2-2.15.2.19">
                  <p id="section-5.4.2-2.15.2.19.1">If <em>attributeName</em> is a byte-case-insensitive match for <code>SameSite</code>:<a href="#section-5.4.2-2.15.2.19.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2-2.15.2.19.2">
<li id="section-5.4.2-2.15.2.19.2.1">
                      <p id="section-5.4.2-2.15.2.19.2.1.1">If <em>attributeValue</em> is a byte-case-insensitive match for <code>None</code>, then set <em>cookie</em>'s same-site to "none".<a href="#section-5.4.2-2.15.2.19.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.19.2.2">
                      <p id="section-5.4.2-2.15.2.19.2.2.1">If <em>attributeValue</em> is a byte-case-insensitive match for <code>Strict</code>, then set <em>cookie</em>'s same-site to "strict".<a href="#section-5.4.2-2.15.2.19.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.2-2.15.2.19.2.3">
                      <p id="section-5.4.2-2.15.2.19.2.3.1">If <em>attributeValue</em> is a byte-case-insensitive match for <code>Lax</code>, then set <em>cookie</em>'s same-site to "lax".<a href="#section-5.4.2-2.15.2.19.2.3.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
</li>
              </ol>
</li>
            <li id="section-5.4.2-2.16">
              <p id="section-5.4.2-2.16.1">Return <em>cookie</em>.<a href="#section-5.4.2-2.16.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-5.4.2-3">Note: Attributes with an unrecognized <em>attributeName</em> are ignored.<a href="#section-5.4.2-3" class="pilcrow">¶</a></p>
<p id="section-5.4.2-4">Note: This intentionally overrides earlier cookie attributes so that generally the last specified
cookie attribute "wins".<a href="#section-5.4.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="store-a-cookie">
<section id="section-5.4.3">
          <h4 id="name-store-a-cookie">
<a href="#section-5.4.3" class="section-number selfRef">5.4.3. </a><a href="#name-store-a-cookie" class="section-name selfRef">Store a Cookie</a>
          </h4>
<p id="section-5.4.3-1">To <strong>Store a Cookie</strong> given a cookie <em>cookie</em>, boolean <em>isSecure</em>, domain or IP address <em>host</em>,
boolean <em>httpOnlyAllowed</em>, boolean <em>allowNonHostOnlyCookieForPublicSuffix</em>, and boolean <em>sameSiteStrictOrLaxAllowed</em>:<a href="#section-5.4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-2">
<li id="section-5.4.3-2.1">
              <p id="section-5.4.3-2.1.1">Assert: <em>cookie</em>'s name's length + <em>cookie</em>'s value's length is not 0 or greater than 4096.<a href="#section-5.4.3-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.2">
              <p id="section-5.4.3-2.2.1">Assert: <em>cookie</em>'s name does not contain a byte in the range 0x00 to 0x08, inclusive, in the range 0x0A to 0x1F, inclusive, or
0x7F (CTL characters excluding HTAB).<a href="#section-5.4.3-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.3">
              <p id="section-5.4.3-2.3.1">If <em>cookie</em>'s host is failure, then return null.<a href="#section-5.4.3-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.4">
              <p id="section-5.4.3-2.4.1">Set <em>cookie</em>'s creation-time and last-access-time to the current date and time.<a href="#section-5.4.3-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.5">
              <p id="section-5.4.3-2.5.1">If <em>allowNonHostOnlyCookieForPublicSuffix</em> is false and <em>cookie</em>'s host is a public suffix:<a href="#section-5.4.3-2.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-2.5.2">
<li id="section-5.4.3-2.5.2.1">
                  <p id="section-5.4.3-2.5.2.1.1">If <em>cookie</em>'s host is host-equal to <em>host</em>, then set <em>cookie</em>'s host to null.<a href="#section-5.4.3-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.3-2.5.2.2">
                  <p id="section-5.4.3-2.5.2.2.1">Otherwise, return null.<a href="#section-5.4.3-2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ol>
<p id="section-5.4.3-2.5.3">
Note: This step prevents <code>attacker.example</code> from disrupting the integrity of
 <code>site.example</code> by setting a cookie with a <code>Domain</code> attribute of <code>example</code>. In the
 event the end user navigates directly to <code>example</code>, a cookie can still be set and
 will forcibly have its host-only set to true.<a href="#section-5.4.3-2.5.3" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.6">
              <p id="section-5.4.3-2.6.1">If <em>cookie</em>'s host is null:<a href="#section-5.4.3-2.6.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-2.6.2">
<li id="section-5.4.3-2.6.2.1">
                  <p id="section-5.4.3-2.6.2.1.1">Set <em>cookie</em>'s host-only to true.<a href="#section-5.4.3-2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.3-2.6.2.2">
                  <p id="section-5.4.3-2.6.2.2.1">Set <em>cookie</em>'s host to <em>host</em>.<a href="#section-5.4.3-2.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-5.4.3-2.7">
              <p id="section-5.4.3-2.7.1">Otherwise:<a href="#section-5.4.3-2.7.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-2.7.2">
<li id="section-5.4.3-2.7.2.1">
                  <p id="section-5.4.3-2.7.2.1.1">If <em>host</em> does not Domain-Match <em>cookie</em>'s host, then return null.<a href="#section-5.4.3-2.7.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.3-2.7.2.2">
                  <p id="section-5.4.3-2.7.2.2.1">Set <em>cookie</em>'s host-only to false.<a href="#section-5.4.3-2.7.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-5.4.3-2.8">
              <p id="section-5.4.3-2.8.1">Assert: <em>cookie</em>'s host is a domain or IP address.<a href="#section-5.4.3-2.8.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.9">
              <p id="section-5.4.3-2.9.1">If <em>httpOnlyAllowed</em> is false and <em>cookie</em>'s http-only is true, then return null.<a href="#section-5.4.3-2.9.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.10">
              <p id="section-5.4.3-2.10.1">If <em>isSecure</em> is false:<a href="#section-5.4.3-2.10.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-2.10.2">
<li id="section-5.4.3-2.10.2.1">
                  <p id="section-5.4.3-2.10.2.1.1">If <em>cookie</em>'s secure is true, then return null.<a href="#section-5.4.3-2.10.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.3-2.10.2.2">
                  <p id="section-5.4.3-2.10.2.2.1">If the user agent's cookie store contains at least one cookie <em>existingCookie</em> that meets all of the following criteria:<a href="#section-5.4.3-2.10.2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-2.10.2.2.2">
<li id="section-5.4.3-2.10.2.2.2.1">
                      <p id="section-5.4.3-2.10.2.2.2.1.1"><em>existingCookie</em>'s name is <em>cookie</em>'s name;<a href="#section-5.4.3-2.10.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.3-2.10.2.2.2.2">
                      <p id="section-5.4.3-2.10.2.2.2.2.1"><em>existingCookie</em>'s secure is true;<a href="#section-5.4.3-2.10.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.3-2.10.2.2.2.3">
                      <p id="section-5.4.3-2.10.2.2.2.3.1"><em>existingCookie</em>'s host Domain-Matches <em>cookie</em>'s host, or vice-versa; and<a href="#section-5.4.3-2.10.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                    <li id="section-5.4.3-2.10.2.2.2.4">
                      <p id="section-5.4.3-2.10.2.2.2.4.1"><em>cookie</em>'s path Path-Matches <em>existingCookie</em>'s path,<a href="#section-5.4.3-2.10.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                  </ol>
<p id="section-5.4.3-2.10.2.2.3">
then return null.<a href="#section-5.4.3-2.10.2.2.3" class="pilcrow">¶</a></p>
<p id="section-5.4.3-2.10.2.2.4">
Note: The path comparison is not symmetric, ensuring only that a newly-created, non-secure
cookie does not overlay an existing secure cookie, providing some mitigation against
cookie-fixing attacks. That is, given an existing secure cookie named 'a' with a path of
'/login', a non-secure cookie named 'a' could be set for a path of '/' or '/foo', but not for
a path of '/login' or '/login/en'.<a href="#section-5.4.3-2.10.2.2.4" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-5.4.3-2.11">
              <p id="section-5.4.3-2.11.1">If <em>cookie</em>'s same-site is not "<code>none</code>" and <em>sameSiteStrictOrLaxAllowed</em> is false,
then return null.<a href="#section-5.4.3-2.11.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.12">
              <p id="section-5.4.3-2.12.1">If <em>cookie</em>'s same-site is "<code>none</code>" and <em>cookie</em>'s secure is false,
then return null.<a href="#section-5.4.3-2.12.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.13">
              <p id="section-5.4.3-2.13.1">If <em>cookie</em>'s name, byte-lowercased, starts with <code>__secure-</code> and <em>cookie</em>'s secure is false,
then return null.<a href="#section-5.4.3-2.13.1" class="pilcrow">¶</a></p>
<p id="section-5.4.3-2.13.2">
Note: The check here and those below are with a byte-lowercased value in order to protect servers that process these values in a case-insensitive manner.<a href="#section-5.4.3-2.13.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.14">
              <p id="section-5.4.3-2.14.1">If <em>cookie</em>'s name, byte-lowercased, starts with <code>__host-</code> and <em>cookie</em> is not Host-prefix compatible, then return null.<a href="#section-5.4.3-2.14.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.15">
              <p id="section-5.4.3-2.15.1">If <em>cookie</em>'s name, byte-lowercased, starts with <code>__http-</code> and <em>cookie</em> is not Http-prefix compatible, then return null.<a href="#section-5.4.3-2.15.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.16">
              <p id="section-5.4.3-2.16.1">If <em>cookie</em>'s name, byte-lowercased, starts with <code>__hosthttp-</code> and <em>cookie</em> is not both Host-prefix compatible and Http-prefix compatible, then return null.<a href="#section-5.4.3-2.16.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.17">
              <p id="section-5.4.3-2.17.1">If <em>cookie</em>'s name is the empty byte sequence and one of the following is true:<a href="#section-5.4.3-2.17.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.3-2.17.2.1">
                  <p id="section-5.4.3-2.17.2.1.1"><em>cookie</em>'s value, byte-lowercased, starts with <code>__secure-</code>,<a href="#section-5.4.3-2.17.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.4.3-2.17.2.2">
                  <p id="section-5.4.3-2.17.2.2.1"><em>cookie</em>'s value, byte-lowercased, starts with <code>__host-</code>,<a href="#section-5.4.3-2.17.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.4.3-2.17.2.3">
                  <p id="section-5.4.3-2.17.2.3.1"><em>cookie</em>'s value, byte-lowercased, starts with <code>__http-</code>, or<a href="#section-5.4.3-2.17.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.4.3-2.17.2.4">
                  <p id="section-5.4.3-2.17.2.4.1"><em>cookie</em>'s value, byte-lowercased, starts with <code>__hosthttp-</code>,<a href="#section-5.4.3-2.17.2.4.1" class="pilcrow">¶</a></p>
</li>
              </ul>
<p id="section-5.4.3-2.17.3">
then return null.<a href="#section-5.4.3-2.17.3" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.18">
              <p id="section-5.4.3-2.18.1">If the user agent's cookie store contains a cookie <em>oldCookie</em> whose name is <em>cookie</em>'s name,
host is host-equal to <em>cookie</em>'s host, host-only is <em>cookie</em>'s host-only, and path is path-equal to <em>cookie</em>'s path:<a href="#section-5.4.3-2.18.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-2.18.2">
<li id="section-5.4.3-2.18.2.1">
                  <p id="section-5.4.3-2.18.2.1.1">If <em>httpOnlyAllowed</em> is false and <em>oldCookie</em>'s http-only is true,
then return null.<a href="#section-5.4.3-2.18.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.3-2.18.2.2">
                  <p id="section-5.4.3-2.18.2.2.1">If <em>cookie</em>'s secure is equal to <em>oldCookie</em>'s secure, <em>cookie</em>'s same-site is equal to <em>oldCookie</em>'s
same-site, and <em>cookie</em>'s expiry-time is equal to <em>oldCookie</em>'s expiry-time, then return null.<a href="#section-5.4.3-2.18.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.3-2.18.2.3">
                  <p id="section-5.4.3-2.18.2.3.1">Set <em>cookie</em>'s creation-time to <em>oldCookie</em>'s creation-time.<a href="#section-5.4.3-2.18.2.3.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.3-2.18.2.4">
                  <p id="section-5.4.3-2.18.2.4.1">Remove <em>oldCookie</em> from the user agent's cookie store.<a href="#section-5.4.3-2.18.2.4.1" class="pilcrow">¶</a></p>
</li>
              </ol>
<p id="section-5.4.3-2.18.3">
Note: This algorithm maintains the invariant that there is at most one such cookie.<a href="#section-5.4.3-2.18.3" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.19">
              <p id="section-5.4.3-2.19.1">Insert <em>cookie</em> into the user agent's cookie store.<a href="#section-5.4.3-2.19.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-2.20">
              <p id="section-5.4.3-2.20.1">Return <em>cookie</em>.<a href="#section-5.4.3-2.20.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="garbage-collect-cookies">
<section id="section-5.4.4">
          <h4 id="name-garbage-collect-cookies">
<a href="#section-5.4.4" class="section-number selfRef">5.4.4. </a><a href="#name-garbage-collect-cookies" class="section-name selfRef">Garbage Collect Cookies</a>
          </h4>
<p id="section-5.4.4-1">To <strong>Garbage Collect Cookies</strong> given a host <em>host</em>:<a href="#section-5.4.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.4-2">
<li id="section-5.4.4-2.1">
              <p id="section-5.4.4-2.1.1">Let <em>expiredCookies</em> be the result of running Remove Expired Cookies.<a href="#section-5.4.4-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.4-2.2">
              <p id="section-5.4.4-2.2.1">Let <em>excessHostCookies</em> be the result of running Remove Excess Cookies for Host given <em>host</em>.<a href="#section-5.4.4-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.4-2.3">
              <p id="section-5.4.4-2.3.1">Let <em>excessGlobalCookies</em> be the result of running Remove Global Excess Cookies.<a href="#section-5.4.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.4-2.4">
              <p id="section-5.4.4-2.4.1">Let <em>removedCookies</em> be « ».<a href="#section-5.4.4-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.4-2.5">
              <p id="section-5.4.4-2.5.1">For each <em>cookieList</em> of « <em>expiredCookies</em>, <em>excessHostCookies</em>, <em>excessGlobalCookies</em> », do the following:<a href="#section-5.4.4-2.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.4-2.5.2">
<li id="section-5.4.4-2.5.2.1">
                  <p id="section-5.4.4-2.5.2.1.1">Extend <em>removedCookies</em> with <em>cookieList</em>.<a href="#section-5.4.4-2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-5.4.4-2.6">
              <p id="section-5.4.4-2.6.1">Return <em>removedCookies</em><a href="#section-5.4.4-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="retrieve-cookies">
<section id="section-5.4.5">
          <h4 id="name-retrieve-cookies">
<a href="#section-5.4.5" class="section-number selfRef">5.4.5. </a><a href="#name-retrieve-cookies" class="section-name selfRef">Retrieve Cookies</a>
          </h4>
<p id="section-5.4.5-1">To <strong>Retrieve Cookies</strong> given a boolean <em>isSecure</em>, host <em>host</em>, URL path <em>path</em>,
boolean <em>httpOnlyAllowed</em>, and string <em>sameSite</em>:<a href="#section-5.4.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.5-2">
<li id="section-5.4.5-2.1">
              <p id="section-5.4.5-2.1.1">Assert: <em>sameSite</em> is "<code>strict-or-less</code>", "<code>lax-or-less</code>", "<code>unset-or-less</code>", or "<code>none</code>".<a href="#section-5.4.5-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.5-2.2">
              <p id="section-5.4.5-2.2.1">Let <em>cookies</em> be all cookies from the user agent's cookie store that meet these conditions:<a href="#section-5.4.5-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.5-2.2.2.1">
                  <p id="section-5.4.5-2.2.2.1.1">One of the following is true:<a href="#section-5.4.5-2.2.2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.5-2.2.2.1.2.1">
                      <p id="section-5.4.5-2.2.2.1.2.1.1">cookie's host-only is true and <em>host</em> is host-equal to cookie's host, or<a href="#section-5.4.5-2.2.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.4.5-2.2.2.1.2.2">
                      <p id="section-5.4.5-2.2.2.1.2.2.1">cookie's host-only is false and <em>host</em> Domain-Matches cookie's host.<a href="#section-5.4.5-2.2.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
<p id="section-5.4.5-2.2.2.1.3">
It's possible that the public suffix list changed since a cookie was
created. If this change results in a cookie's host becoming a public
suffix and the cookie's host-only is false, then that cookie SHOULD NOT
be returned.<a href="#section-5.4.5-2.2.2.1.3" class="pilcrow">¶</a></p>
<p id="section-5.4.5-2.2.2.1.4">
XXX: We should probably move this requirement out-of-bound as this invalidation
should happen as part of updating the public suffixes.<a href="#section-5.4.5-2.2.2.1.4" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.4.5-2.2.2.2">
                  <p id="section-5.4.5-2.2.2.2.1"><em>path</em> Path-Matches cookie's path.<a href="#section-5.4.5-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.4.5-2.2.2.3">
                  <p id="section-5.4.5-2.2.2.3.1">One of the following is true:<a href="#section-5.4.5-2.2.2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.5-2.2.2.3.2.1">
                      <p id="section-5.4.5-2.2.2.3.2.1.1">cookie's secure is true and <em>isSecure</em> is true, or<a href="#section-5.4.5-2.2.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.4.5-2.2.2.3.2.2">
                      <p id="section-5.4.5-2.2.2.3.2.2.1">cookie's secure is false.<a href="#section-5.4.5-2.2.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-5.4.5-2.2.2.4">
                  <p id="section-5.4.5-2.2.2.4.1">One of the following is true:<a href="#section-5.4.5-2.2.2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.5-2.2.2.4.2.1">
                      <p id="section-5.4.5-2.2.2.4.2.1.1">cookie's http-only is true and <em>httpOnlyAllowed</em> is true, or<a href="#section-5.4.5-2.2.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.4.5-2.2.2.4.2.2">
                      <p id="section-5.4.5-2.2.2.4.2.2.1">cookie's http-only is false.<a href="#section-5.4.5-2.2.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
                <li class="normal" id="section-5.4.5-2.2.2.5">
                  <p id="section-5.4.5-2.2.2.5.1">One of the following is true:<a href="#section-5.4.5-2.2.2.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.5-2.2.2.5.2.1">
                      <p id="section-5.4.5-2.2.2.5.2.1.1">cookie's same-site is "<code>strict</code>" and <em>sameSite</em> is "<code>strict-or-less</code>";<a href="#section-5.4.5-2.2.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.4.5-2.2.2.5.2.2">
                      <p id="section-5.4.5-2.2.2.5.2.2.1">cookie's same-site is "<code>lax</code>" and <em>sameSite</em> is one of "<code>strict-or-less</code>" or "<code>lax-or-less</code>";<a href="#section-5.4.5-2.2.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.4.5-2.2.2.5.2.3">
                      <p id="section-5.4.5-2.2.2.5.2.3.1">cookie's same-site is "<code>unset</code>" and <em>sameSite</em> is one of "<code>strict-or-less</code>", "<code>lax-or-less</code>", or "<code>unset-or-less</code>"; or<a href="#section-5.4.5-2.2.2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
                    <li class="normal" id="section-5.4.5-2.2.2.5.2.4">
                      <p id="section-5.4.5-2.2.2.5.2.4.1">cookie's same-site is "<code>none</code>".<a href="#section-5.4.5-2.2.2.5.2.4.1" class="pilcrow">¶</a></p>
</li>
                  </ul>
</li>
              </ul>
</li>
            <li id="section-5.4.5-2.3">
              <p id="section-5.4.5-2.3.1">Sort <em>cookies</em> in the following order:<a href="#section-5.4.5-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4.5-2.3.2.1">
                  <p id="section-5.4.5-2.3.2.1.1">Cookies whose path's size is greater are listed before cookies whose path's size
is smaller.<a href="#section-5.4.5-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-5.4.5-2.3.2.2">
                  <p id="section-5.4.5-2.3.2.2.1">Among cookies whose path's size is equal, cookies whose creation-time is earlier
are listed before cookies whose creation-time is later.<a href="#section-5.4.5-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-5.4.5-2.4">
              <p id="section-5.4.5-2.4.1">Set the last-access-time of each cookie of <em>cookies</em> to the current date and time
and reflect these changes in the user agent's cookie store.<a href="#section-5.4.5-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.5-2.5">
              <p id="section-5.4.5-2.5.1">Return <em>cookies</em>.<a href="#section-5.4.5-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="serialize-cookies">
<section id="section-5.4.6">
          <h4 id="name-serialize-cookies">
<a href="#section-5.4.6" class="section-number selfRef">5.4.6. </a><a href="#name-serialize-cookies" class="section-name selfRef">Serialize Cookies</a>
          </h4>
<p id="section-5.4.6-1">To <strong>Serialize Cookies</strong> given a list of cookies <em>cookies</em>:<a href="#section-5.4.6-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.6-2">
<li id="section-5.4.6-2.1">
              <p id="section-5.4.6-2.1.1">Let <em>output</em> be an empty byte sequence.<a href="#section-5.4.6-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.6-2.2">
              <p id="section-5.4.6-2.2.1">For each <em>cookie</em> of <em>cookies</em>:<a href="#section-5.4.6-2.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.6-2.2.2">
<li id="section-5.4.6-2.2.2.1">
                  <p id="section-5.4.6-2.2.2.1.1">If <em>output</em> is not the empty byte sequence, then append 0x3B (;) followed by 0x20 (SP) to <em>output</em>.<a href="#section-5.4.6-2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.6-2.2.2.2">
                  <p id="section-5.4.6-2.2.2.2.1">If <em>cookie</em>'s name is not the empty byte sequence, then append <em>cookie</em>'s name followed by
0x3D (=) to <em>output</em>.<a href="#section-5.4.6-2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                <li id="section-5.4.6-2.2.2.3">
                  <p id="section-5.4.6-2.2.2.3.1">Append <em>cookie</em>'s value to <em>output</em>.<a href="#section-5.4.6-2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              </ol>
</li>
            <li id="section-5.4.6-2.3">
              <p id="section-5.4.6-2.3.1">Return <em>output</em>.<a href="#section-5.4.6-2.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="requirements-specific-to-non-browser-user-agents">
<section id="section-5.5">
        <h3 id="name-requirements-specific-to-no">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-requirements-specific-to-no" class="section-name selfRef">Requirements Specific to Non-Browser User Agents</a>
        </h3>
<div id="set-cookie">
<section id="section-5.5.1">
          <h4 id="name-the-set-cookie-header-field">
<a href="#section-5.5.1" class="section-number selfRef">5.5.1. </a><a href="#name-the-set-cookie-header-field" class="section-name selfRef">The Set-Cookie Header Field</a>
          </h4>
<p id="section-5.5.1-1">When a user agent receives a <code>Set-Cookie</code> header field in an HTTP response, the
user agent MAY ignore the <code>Set-Cookie</code> header field in its entirety as per its cookie policy
(see <a href="#cookie-policy" class="auto internal xref">Section 7.2</a>).<a href="#section-5.5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.5.1-2">User agents MAY ignore <code>Set-Cookie</code> header fields contained in responses with 100-level
status codes.<a href="#section-5.5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.5.1-3"><code>Set-Cookie</code> header fields contained in responses with non-100-level status
codes (including those in responses with 400- and 500-level status codes)
SHOULD be processed as follows:<a href="#section-5.5.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5.1-4">
<li id="section-5.5.1-4.1">
              <p id="section-5.5.1-4.1.1">Let <em>isSecure</em> be a boolean indicating whether request's URL's scheme is deemed secure, in an implementation-defined manner.<a href="#section-5.5.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.1-4.2">
              <p id="section-5.5.1-4.2.1">Let <em>host</em> be request's host.<a href="#section-5.5.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.1-4.3">
              <p id="section-5.5.1-4.3.1">Let <em>path</em> be request's URL's path.<a href="#section-5.5.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.1-4.4">
              <p id="section-5.5.1-4.4.1">Let <em>httpOnlyAllowed</em> be true.<a href="#section-5.5.1-4.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.1-4.5">
              <p id="section-5.5.1-4.5.1">Let <em>allowNonHostOnlyCookieForPublicSuffix</em> be a boolean whose value is implementation-defined.<a href="#section-5.5.1-4.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.1-4.6">
              <p id="section-5.5.1-4.6.1">Let <em>sameSiteStrictOrLaxAllowed</em> be a boolean whose value is implementation-defined.<a href="#section-5.5.1-4.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.1-4.7">
              <p id="section-5.5.1-4.7.1">Let <em>cookie</em> be the result of running Parse and Store a Cookie given the header field value,
<em>isSecure</em>, <em>host</em>, <em>path</em>, <em>httpOnlyAllowed</em>, <em>allowNonHostOnlyCookieForPublicSuffix</em>, and
<em>sameSiteStrictOrLaxAllowed</em>.<a href="#section-5.5.1-4.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.1-4.8">
              <p id="section-5.5.1-4.8.1">If <em>cookie</em> is null, then return.<a href="#section-5.5.1-4.8.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.1-4.9">
              <p id="section-5.5.1-4.9.1">Run Garbage Collect Cookies given <em>cookie</em>'s host.<a href="#section-5.5.1-4.9.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
<div id="cookie">
<section id="section-5.5.2">
          <h4 id="name-the-cookie-header-field">
<a href="#section-5.5.2" class="section-number selfRef">5.5.2. </a><a href="#name-the-cookie-header-field" class="section-name selfRef">The Cookie Header Field</a>
          </h4>
<p id="section-5.5.2-1">The user agent includes stored cookies in the <code>Cookie</code> request header field.<a href="#section-5.5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.5.2-2">When the user agent generates an HTTP request, the user agent MUST NOT attach
more than one <code>Cookie</code> header field.<a href="#section-5.5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.5.2-3">A user agent MAY omit the <code>Cookie</code> header field in its entirety.<a href="#section-5.5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.5.2-4">If the user agent does attach a <code>Cookie</code> header field to an HTTP request, the
user agent MUST compute its value as follows:<a href="#section-5.5.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.5.2-5">
<li id="section-5.5.2-5.1">
              <p id="section-5.5.2-5.1.1">Let <em>isSecure</em> be a boolean indicating whether request's URL's scheme is deemed secure, in an implementation-defined manner.<a href="#section-5.5.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.2-5.2">
              <p id="section-5.5.2-5.2.1">Let <em>host</em> be request's host.<a href="#section-5.5.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.2-5.3">
              <p id="section-5.5.2-5.3.1">Let <em>path</em> be request's URL's path.<a href="#section-5.5.2-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.2-5.4">
              <p id="section-5.5.2-5.4.1">Let <em>httpOnlyAllowed</em> be true.<a href="#section-5.5.2-5.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.2-5.5">
              <p id="section-5.5.2-5.5.1">Let <em>sameSite</em> be a string whose value is implementation-defined, but has to be one of
"<code>strict-or-less</code>", "<code>lax-or-less</code>", "<code>unset-or-less</code>", or "<code>none</code>".<a href="#section-5.5.2-5.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.2-5.6">
              <p id="section-5.5.2-5.6.1">Let <em>cookies</em> be the result of running Retrieve Cookies given <em>isSecure</em>, <em>host</em>, <em>path</em>,
<em>httpOnlyAllowed</em>, and <em>sameSite</em>.<a href="#section-5.5.2-5.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.5.2-5.7">
              <p id="section-5.5.2-5.7.1">Return the result of running Serialize Cookies given <em>cookies</em>.<a href="#section-5.5.2-5.7.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-5.5.2-6">Note: Previous versions of this specification required that only one Cookie
header field be sent in requests. This is no longer a requirement. While this
specification requires that a single cookie-string be produced, some user agents
may split that string across multiple <code>Cookie</code> header fields. For examples, see
<span><a href="https://rfc-editor.org/rfc/rfc9113#section-8.2.3" class="relref">Section 8.2.3</a> of [<a href="#RFC9113" class="cite xref">RFC9113</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc9114#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#RFC9114" class="cite xref">HTTP</a>]</span>.<a href="#section-5.5.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cookie-store-eviction-for-non-browser-user-agents">
<section id="section-5.5.3">
          <h4 id="name-cookie-store-eviction-for-n">
<a href="#section-5.5.3" class="section-number selfRef">5.5.3. </a><a href="#name-cookie-store-eviction-for-n" class="section-name selfRef">Cookie Store Eviction for Non-Browser User Agents</a>
          </h4>
<p id="section-5.5.3-1">The user agent SHOULD evict all expired cookies from its cookie store if, at any
time, an expired cookie exists in the cookie store, by calling Remove Expired Cookies.<a href="#section-5.5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.5.3-2">When "the current session is over" (as defined by the user agent), the user
agent MUST remove from the cookie store all cookies whose expiry-time is null.<a href="#section-5.5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="requirements-specific-to-browser-user-agents">
<section id="section-5.6">
        <h3 id="name-requirements-specific-to-br">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-requirements-specific-to-br" class="section-name selfRef">Requirements Specific to Browser User Agents</a>
        </h3>
<p id="section-5.6-1">While browsers are expected to generally follow the same model as non-browser user agents, they
have additional complexity due to the document model (and the ability to nest documents) that is
considered out-of-scope for this specification.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">Specifications for such a user agent are expected to build upon the following algorithms
and invoke them appropriately to process <code>Cookie</code> and <code>Set-Cookie</code> header fields, as well as
manipulating the user agent's cookie store through non-HTTP APIs:<a href="#section-5.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6-3.1">
            <p id="section-5.6-3.1.1">Parse and Store a Cookie<a href="#section-5.6-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.6-3.2">
            <p id="section-5.6-3.2.1">Store a Cookie<a href="#section-5.6-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.6-3.3">
            <p id="section-5.6-3.3.1">Remove Expired Cookies<a href="#section-5.6-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.6-3.4">
            <p id="section-5.6-3.4.1">Garbage Collect Cookies<a href="#section-5.6-3.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.6-3.5">
            <p id="section-5.6-3.5.1">Retrieve Cookies<a href="#section-5.6-3.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.6-3.6">
            <p id="section-5.6-3.6.1">Serialize Cookies<a href="#section-5.6-3.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.6-4">This provides the flexibility browsers need to detail their requirements in considerable detail.<a href="#section-5.6-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-considerations">
<section id="section-6">
      <h2 id="name-implementation-consideratio">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-implementation-consideratio" class="section-name selfRef">Implementation Considerations</a>
      </h2>
<div id="limits">
<section id="section-6.1">
        <h3 id="name-limits">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-limits" class="section-name selfRef">Limits</a>
        </h3>
<p id="section-6.1-1">Servers SHOULD use as few and as small cookies as possible to avoid reaching
these implementation limits, minimize network bandwidth due to the
<code>Cookie</code> header field being included in every request, and to avoid reaching
server header field limits (See <a href="#server-syntax" class="auto internal xref">Section 4.2.1</a>).<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Servers SHOULD gracefully degrade if the user agent fails to return one or more
cookies in the <code>Cookie</code> header field because the user agent might evict any cookie
at any time.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="application-programming-interfaces">
<section id="section-6.2">
        <h3 id="name-application-programming-int">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-application-programming-int" class="section-name selfRef">Application Programming Interfaces</a>
        </h3>
<p id="section-6.2-1">One reason the <code>Cookie</code> and <code>Set-Cookie</code> header fields use such esoteric syntax is
that many platforms (both in servers and user agents) provide a string-based
application programming interface (API) to cookies, requiring
application-layer programmers to generate and parse the syntax used by the
<code>Cookie</code> and <code>Set-Cookie</code> header fields, which many programmers have done incorrectly,
resulting in interoperability problems.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Instead of providing string-based APIs to cookies, platforms would be
well-served by providing more semantic APIs. It is beyond the scope of this
document to recommend specific API designs, but there are clear benefits to
accepting an abstract "Date" object instead of a serialized date string.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-7">
      <h2 id="name-privacy-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-7-1">Cookies' primary privacy risk is their ability to correlate user activity. This
can happen on a single site, but is most problematic when activity is tracked across different,
seemingly unconnected Web sites to build a user profile.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Over time, this capability (warned against explicitly in <span>[<a href="#RFC2109" class="cite xref">RFC2109</a>]</span> and all of its successors)
has become widely used for varied reasons including:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.1">
          <p id="section-7-3.1.1">authenticating users across sites,<a href="#section-7-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.2">
          <p id="section-7-3.2.1">assembling information on users,<a href="#section-7-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.3">
          <p id="section-7-3.3.1">protecting against fraud and other forms of undesirable traffic,<a href="#section-7-3.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.4">
          <p id="section-7-3.4.1">targeting advertisements at specific users or at users with specified attributes,<a href="#section-7-3.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.5">
          <p id="section-7-3.5.1">measuring how often ads are shown to users, and<a href="#section-7-3.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.6">
          <p id="section-7-3.6.1">recognizing when an ad resulted in a change in user behavior.<a href="#section-7-3.6.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-4">While not every use of cookies is necessarily problematic for privacy, their potential for abuse
has become a widespread concern in the Internet community and broader society. In response to these concerns, user agents
have actively constrained cookie functionality in various ways (as allowed and encouraged by
previous specifications), while avoiding disruption to features they judge desirable for the health
of the Web.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">It is too early to declare consensus on which specific mechanism(s) should be used to mitigate cookies' privacy impact; user agents' ongoing changes to how they are handled are best characterised as experiments that
can provide input into that eventual consensus.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">Instead, this document describes limited, general mitigations against the privacy risks associated
with cookies that enjoy wide deployment at the time of writing. It is expected that implementations
will continue to experiment and impose stricter, more well-defined limitations on cookies over
time. Future versions of this document might codify those mechanisms based upon deployment
experience. If functions that currently rely on cookies can be supported by separate, targeted
mechanisms, they might be documented in separate specifications and stricter limitations on cookies
might become feasible.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">Note that cookies are not the only mechanism that can be used to track users across sites, so while
these mitigations are necessary to improve Web privacy, they are not sufficient on their own.<a href="#section-7-7" class="pilcrow">¶</a></p>
<div id="third-party-cookies">
<section id="section-7.1">
        <h3 id="name-third-party-cookies">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-third-party-cookies" class="section-name selfRef">Third-Party Cookies</a>
        </h3>
<p id="section-7.1-1">A "third-party" or cross-site cookie is one that is associated with embedded content (such as
scripts, images, stylesheets, frames) that is obtained from a different server than the one that
hosts the primary resource (usually, the Web page that the user is viewing). Third-party cookies
are often used to correlate users' activity on different sites.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Because of their inherent privacy issues, most user agents now limit third-party cookies in a
variety of ways. Some completely block third-party cookies by refusing to process third-party
<code>Set-Cookie</code> header fields and refusing to send third-party <code>Cookie</code> header fields. Some partition
cookies based upon the first-party context, so that different cookies are sent depending on the
site being browsed. Some block cookies based upon user agent cookie policy and/or user controls.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">While this document does not endorse or require a specific approach, it is RECOMMENDED that user
agents adopt a policy for third-party cookies that is as restrictive as compatibility constraints
permit. Consequently, resources cannot rely upon third-party cookies being treated consistently by
user agents for the foreseeable future.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cookie-policy">
<section id="section-7.2">
        <h3 id="name-cookie-policy">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-cookie-policy" class="section-name selfRef">Cookie Policy</a>
        </h3>
<p id="section-7.2-1">User agents MAY enforce a cookie policy consisting of restrictions on how
cookies may be used or ignored (see <a href="#set-cookie" class="auto internal xref">Section 5.5.1</a>).<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">A cookie policy may govern which domains or parties, as in first and third parties
(see <a href="#third-party-cookies" class="auto internal xref">Section 7.1</a>), for which the user agent will allow cookie access.
The policy can also define limits on cookie size, cookie expiry (see
<a href="#attribute-expires" class="auto internal xref">Section 4.1.2.1</a> and <a href="#attribute-max-age" class="auto internal xref">Section 4.1.2.2</a>), and the number of cookies per
domain or in total.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">The goal of a restrictive cookie policy is often to improve security or privacy.
User agents often allow users to change the cookie policy (see <a href="#user-controls" class="auto internal xref">Section 7.3</a>).<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="user-controls">
<section id="section-7.3">
        <h3 id="name-user-controls">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-user-controls" class="section-name selfRef">User Controls</a>
        </h3>
<p id="section-7.3-1">User agents SHOULD provide users with a mechanism for managing the cookies
stored in the cookie store. For example, a user agent might let users delete
all cookies received during a specified time period or all the cookies related
to a particular domain. In addition, many user agents include a user interface
element that lets users examine the cookies stored in their cookie store.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">User agents SHOULD provide users with a mechanism for disabling cookies. When
cookies are disabled, the user agent MUST NOT include a <code>Cookie</code> header field in
outbound HTTP requests and the user agent MUST NOT process <code>Set-Cookie</code> header fields
in inbound HTTP responses.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">User agents MAY offer a way to change the cookie policy (see
<a href="#cookie-policy" class="auto internal xref">Section 7.2</a>).<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">User agents MAY provide users the option of preventing persistent storage of
cookies across sessions. When configured thusly, user agents MUST treat all
received cookies as if their expiry-time is null.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="expiration-dates">
<section id="section-7.4">
        <h3 id="name-expiration-dates">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-expiration-dates" class="section-name selfRef">Expiration Dates</a>
        </h3>
<p id="section-7.4-1">Although servers can set the expiration date for cookies to the distant future,
most user agents do not actually retain cookies for multiple decades. Rather
than choosing gratuitously long expiration periods, servers SHOULD promote user
privacy by selecting reasonable cookie expiration periods based on the purpose
of the cookie. For example, a typical session identifier might reasonably be
set to expire in two weeks.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="overview">
<section id="section-8.1">
        <h3 id="name-overview">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-8.1-1">Cookies have a number of security pitfalls. This section overviews a few of the
more salient issues.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">In particular, cookies encourage developers to rely on ambient authority for
authentication, often becoming vulnerable to attacks such as cross-site request
forgery <span>[<a href="#CSRF" class="cite xref">CSRF</a>]</span>. Also, when storing session identifiers in cookies, developers
often create session fixation vulnerabilities.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">Transport-layer encryption, such as that employed in HTTPS, is insufficient to
prevent a network attacker from obtaining or altering a victim's cookies because
the cookie protocol itself has various vulnerabilities (see "Weak Confidentiality"
and "Weak Integrity", below). In addition, by default, cookies do not provide
confidentiality or integrity from network attackers, even when used in conjunction
with HTTPS.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ambient-authority">
<section id="section-8.2">
        <h3 id="name-ambient-authority">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-ambient-authority" class="section-name selfRef">Ambient Authority</a>
        </h3>
<p id="section-8.2-1">A server that uses cookies to authenticate users can suffer security
vulnerabilities because some user agents let remote parties issue HTTP requests
from the user agent (e.g., via HTTP redirects or HTML forms). When issuing
those requests, user agents attach cookies even if the remote party does not
know the contents of the cookies, potentially letting the remote party exercise
authority at an unwary server.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Although this security concern goes by a number of names (e.g., cross-site
request forgery, confused deputy), the issue stems from cookies being a form of
ambient authority. Cookies encourage server operators to separate designation
(in the form of URLs) from authorization (in the form of cookies).
Consequently, the user agent might supply the authorization for a resource
designated by the attacker, possibly causing the server or its clients to
undertake actions designated by the attacker as though they were authorized by
the user.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Instead of using cookies for authorization, server operators might wish to
consider entangling designation and authorization by treating URLs as
capabilities. Instead of storing secrets in cookies, this approach stores
secrets in URLs, requiring the remote entity to supply the secret itself.
Although this approach is not a panacea, judicious application of these
principles can lead to more robust security.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="clear-text">
<section id="section-8.3">
        <h3 id="name-clear-text">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-clear-text" class="section-name selfRef">Clear Text</a>
        </h3>
<p id="section-8.3-1">Unless sent over a secure channel (such as TLS <span>[<a href="#RFC8446" class="cite xref">TLS13</a>]</span>), the information in the <code>Cookie</code>
and <code>Set-Cookie</code> header fields is transmitted in the clear.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-8.3-2">
<li id="section-8.3-2.1">
            <p id="section-8.3-2.1.1">All sensitive information conveyed in these header fields is exposed to an
eavesdropper.<a href="#section-8.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.3-2.2">
            <p id="section-8.3-2.2.1">A malicious intermediary could alter the header fields as they travel in either
direction, with unpredictable results.<a href="#section-8.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-8.3-2.3">
            <p id="section-8.3-2.3.1">A malicious client could alter the <code>Cookie</code> header fields before transmission,
with unpredictable results.<a href="#section-8.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-8.3-3">Servers SHOULD encrypt and sign the contents of cookies (using whatever format
the server desires) when transmitting them to the user agent (even when sending
the cookies over a secure channel). However, encrypting and signing cookie
contents does not prevent an attacker from transplanting a cookie from one user
agent to another or from replaying the cookie at a later time.<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<p id="section-8.3-4">In addition to encrypting and signing the contents of every cookie, servers that
require a higher level of security SHOULD use the <code>Cookie</code> and <code>Set-Cookie</code>
header fields only over a secure channel. When using cookies over a secure channel,
servers SHOULD set the Secure attribute (see <a href="#attribute-secure" class="auto internal xref">Section 4.1.2.5</a>) for every
cookie. If a server does not set the Secure attribute, the protection
provided by the secure channel will be largely moot.<a href="#section-8.3-4" class="pilcrow">¶</a></p>
<p id="section-8.3-5">For example, consider a webmail server that stores a session identifier in a
cookie and is typically accessed over HTTPS. If the server does not set the
Secure attribute on its cookies, an active network attacker can intercept any
outbound HTTP request from the user agent and redirect that request to the
webmail server over HTTP. Even if the webmail server is not listening for HTTP
connections, the user agent will still include cookies in the request. The
active network attacker can intercept these cookies, replay them against the
server, and learn the contents of the user's email. If, instead, the server had
set the Secure attribute on its cookies, the user agent would not have
included the cookies in the clear-text request.<a href="#section-8.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="session-identifiers">
<section id="section-8.4">
        <h3 id="name-session-identifiers">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-session-identifiers" class="section-name selfRef">Session Identifiers</a>
        </h3>
<p id="section-8.4-1">Instead of storing session information directly in a cookie (where it might be
exposed to or replayed by an attacker), servers commonly store a nonce (or
"session identifier") in a cookie. When the server receives an HTTP request
with a nonce, the server can look up state information associated with the
cookie using the nonce as a key.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">Using session identifier cookies limits the damage an attacker can cause if the
attacker learns the contents of a cookie because the nonce is useful only for
interacting with the server (unlike non-nonce cookie content, which might itself
be sensitive). Furthermore, using a single nonce prevents an attacker from
"splicing" together cookie content from two interactions with the server, which
could cause the server to behave unexpectedly.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">Using session identifiers is not without risk. For example, the server SHOULD
take care to avoid "session fixation" vulnerabilities. A session fixation attack
proceeds in three steps. First, the attacker transplants a session identifier
from his or her user agent to the victim's user agent. Second, the victim uses
that session identifier to interact with the server, possibly imbuing the
session identifier with the user's credentials or confidential information.
Third, the attacker uses the session identifier to interact with server
directly, possibly obtaining the user's authority or confidential information.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="weak-confidentiality">
<section id="section-8.5">
        <h3 id="name-weak-confidentiality">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-weak-confidentiality" class="section-name selfRef">Weak Confidentiality</a>
        </h3>
<p id="section-8.5-1">Cookies do not provide isolation by port. If a cookie is readable by a service
running on one port, the cookie is also readable by a service running on another
port of the same server. If a cookie is writable by a service on one port, the
cookie is also writable by a service running on another port of the same server.
For this reason, servers SHOULD NOT both run mutually distrusting services on
different ports of the same host and use cookies to store security-sensitive
information.<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<p id="section-8.5-2">Cookies do not provide isolation by scheme. Although most commonly used with
the http and https schemes, the cookies for a given host might also be
available to other schemes, such as ftp and gopher. Although this lack of
isolation by scheme is most apparent in non-HTTP APIs that permit access to
cookies (e.g., HTML's document.cookie API), the lack of isolation by scheme
is actually present in requirements for processing cookies themselves (e.g.,
consider retrieving a URI with the gopher scheme via HTTP).<a href="#section-8.5-2" class="pilcrow">¶</a></p>
<p id="section-8.5-3">Cookies do not always provide isolation by path. Although the network-level
protocol does not send cookies stored for one path to another, some user
agents expose cookies via non-HTTP APIs, such as HTML's document.cookie API.
Because some of these user agents (e.g., web browsers) do not isolate resources
received from different paths, a resource retrieved from one path might be able
to access cookies stored for another path.<a href="#section-8.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="weak-integrity">
<section id="section-8.6">
        <h3 id="name-weak-integrity">
<a href="#section-8.6" class="section-number selfRef">8.6. </a><a href="#name-weak-integrity" class="section-name selfRef">Weak Integrity</a>
        </h3>
<p id="section-8.6-1">Cookies do not provide integrity guarantees for sibling domains (and their
subdomains). For example, consider foo.site.example and bar.site.example. The
foo.site.example server can set a cookie with a Domain attribute of
"site.example" (possibly overwriting an existing "site.example" cookie set by
bar.site.example), and the user agent will include that cookie in HTTP requests
to bar.site.example. In the worst case, bar.site.example will be unable to
distinguish this cookie from a cookie it set itself. The foo.site.example
server might be able to leverage this ability to mount an attack against
bar.site.example.<a href="#section-8.6-1" class="pilcrow">¶</a></p>
<p id="section-8.6-2">Even though the <code>Set-Cookie</code> header field supports the Path attribute, the Path
attribute does not provide any integrity protection because the user agent
will accept an arbitrary Path attribute in a <code>Set-Cookie</code> header field. For
example, an HTTP response to a request for http://site.example/foo/bar can set
a cookie with a Path attribute of "/qux". Consequently, servers SHOULD NOT
both run mutually distrusting services on different paths of the same host and
use cookies to store security-sensitive information.<a href="#section-8.6-2" class="pilcrow">¶</a></p>
<p id="section-8.6-3">An active network attacker can also inject cookies into the <code>Cookie</code> header field
sent to <code>https://site.example/</code> by impersonating a response from
<code>http://site.example/</code> and injecting a <code>Set-Cookie</code> header field. The HTTPS server
at site.example will be unable to distinguish these cookies from cookies that
it set itself in an HTTPS response. An active network attacker might be able
to leverage this ability to mount an attack against site.example even if
site.example uses HTTPS exclusively.<a href="#section-8.6-3" class="pilcrow">¶</a></p>
<p id="section-8.6-4">Servers can partially mitigate these attacks by encrypting and signing the
contents of their cookies, or by naming the cookie with the <code>__Secure-</code> prefix.
However, using cryptography does not mitigate the issue completely because an
attacker can replay a cookie he or she received from the authentic site.example
server in the user's session, with unpredictable results.<a href="#section-8.6-4" class="pilcrow">¶</a></p>
<p id="section-8.6-5">Finally, an attacker might be able to force the user agent to delete cookies by
storing a large number of cookies. Once the user agent reaches its storage
limit, the user agent will be forced to evict some cookies. Servers SHOULD NOT
rely upon user agents retaining cookies.<a href="#section-8.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reliance-on-dns">
<section id="section-8.7">
        <h3 id="name-reliance-on-dns">
<a href="#section-8.7" class="section-number selfRef">8.7. </a><a href="#name-reliance-on-dns" class="section-name selfRef">Reliance on DNS</a>
        </h3>
<p id="section-8.7-1">Cookies rely upon the Domain Name System (DNS) for security. If the DNS is
partially or fully compromised, the cookie protocol might fail to provide the
security properties required by applications.<a href="#section-8.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="samesite-cookies">
<section id="section-8.8">
        <h3 id="name-samesite-cookies">
<a href="#section-8.8" class="section-number selfRef">8.8. </a><a href="#name-samesite-cookies" class="section-name selfRef">SameSite Cookies</a>
        </h3>
<p id="section-8.8-1">SameSite cookies offer a robust defense against CSRF attack when deployed in
strict mode, and when supported by the client. It is, however, prudent to ensure
that this designation is not the extent of a site's defense against CSRF, as
same-site navigations and submissions can certainly be executed in conjunction
with other attack vectors such as cross-site scripting.<a href="#section-8.8-1" class="pilcrow">¶</a></p>
<p id="section-8.8-2">Developers are strongly encouraged to deploy the usual server-side defenses
(CSRF tokens, ensuring that "safe" HTTP methods are idempotent, etc) to mitigate
the risk more fully.<a href="#section-8.8-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="iana-cookie">
<section id="section-9.1">
        <h3 id="name-cookie-2">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-cookie-2" class="section-name selfRef">Cookie</a>
        </h3>
<p id="section-9.1-1">The HTTP Field Name Registry (see <span>[<a href="#HttpFieldNameRegistry" class="cite xref">HttpFieldNameRegistry</a>]</span>) needs to be
updated with the following registration:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.1-2">
          <dt id="section-9.1-2.1">Header field name:</dt>
          <dd style="margin-left: 1.5em" id="section-9.1-2.2">
            <p id="section-9.1-2.2.1">Cookie<a href="#section-9.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.3">Applicable protocol:</dt>
          <dd style="margin-left: 1.5em" id="section-9.1-2.4">
            <p id="section-9.1-2.4.1">http<a href="#section-9.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.5">Status:</dt>
          <dd style="margin-left: 1.5em" id="section-9.1-2.6">
            <p id="section-9.1-2.6.1">standard<a href="#section-9.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.7">Author/Change controller:</dt>
          <dd style="margin-left: 1.5em" id="section-9.1-2.8">
            <p id="section-9.1-2.8.1">IETF<a href="#section-9.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.1-2.9">Specification document:</dt>
          <dd style="margin-left: 1.5em" id="section-9.1-2.10">
            <p id="section-9.1-2.10.1">this specification (<a href="#cookie" class="auto internal xref">Section 5.5.2</a>)<a href="#section-9.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="iana-set-cookie">
<section id="section-9.2">
        <h3 id="name-set-cookie-2">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-set-cookie-2" class="section-name selfRef">Set-Cookie</a>
        </h3>
<p id="section-9.2-1">The HTTP Field Name Registry (see <span>[<a href="#HttpFieldNameRegistry" class="cite xref">HttpFieldNameRegistry</a>]</span>) needs to be
updated with the following registration:<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-9.2-2">
          <dt id="section-9.2-2.1">Header field name:</dt>
          <dd style="margin-left: 1.5em" id="section-9.2-2.2">
            <p id="section-9.2-2.2.1">Set-Cookie<a href="#section-9.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.3">Applicable protocol:</dt>
          <dd style="margin-left: 1.5em" id="section-9.2-2.4">
            <p id="section-9.2-2.4.1">http<a href="#section-9.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.5">Status:</dt>
          <dd style="margin-left: 1.5em" id="section-9.2-2.6">
            <p id="section-9.2-2.6.1">standard<a href="#section-9.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.7">Author/Change controller:</dt>
          <dd style="margin-left: 1.5em" id="section-9.2-2.8">
            <p id="section-9.2-2.8.1">IETF<a href="#section-9.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-9.2-2.9">Specification document:</dt>
          <dd style="margin-left: 1.5em" id="section-9.2-2.10">
            <p id="section-9.2-2.10.1">this specification (<a href="#set-cookie" class="auto internal xref">Section 5.5.1</a>)<a href="#section-9.2-2.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="changes">
<section id="section-10">
      <h2 id="name-changes">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-changes" class="section-name selfRef">Changes</a>
      </h2>
<p id="section-10-1">Revamped the document to allow for more detailed requirements on browsers in downstream specifications.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-11">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-11-1">Many thanks to Adam Barth for laying the groundwork for a modern cookie specification with RFC 6265.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">And thanks to John Wilander, Lily Chen, Mike West, Steven Bingler, and Steven Englehardt for improving upon that work in subsequent drafts.<a href="#section-11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-12">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="HTML">[HTML]</dt>
        <dd>
<span class="refAuthor">Hickson, I.</span>, <span class="refAuthor">Pieters, S.</span>, <span class="refAuthor">van Kesteren, A.</span>, <span class="refAuthor">Jägenstedt, P.</span>, and <span class="refAuthor">D. Denicola</span>, <span class="refTitle">"HTML"</span>, <span>n.d.</span>, <span>&lt;<a href="https://html.spec.whatwg.org/">https://html.spec.whatwg.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="INFRA">[INFRA]</dt>
        <dd>
<span class="refAuthor">van Kesteren, A.</span> and <span class="refAuthor">D. Denicola</span>, <span class="refTitle">"Infra"</span>, <span>n.d.</span>, <span>&lt;<a href="https://infra.spec.whatwg.org">https://infra.spec.whatwg.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1034">[RFC1034]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1034">https://www.rfc-editor.org/rfc/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1123">[RFC1123]</dt>
        <dd>
<span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Application and Support"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1123</span>, <span class="seriesInfo">DOI 10.17487/RFC1123</span>, <time datetime="1989-10" class="refDate">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1123">https://www.rfc-editor.org/rfc/rfc1123</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5234">[RFC5234]</dt>
        <dd>
<span class="refAuthor">Crocker, D., Ed.</span> and <span class="refAuthor">P. Overell</span>, <span class="refTitle">"Augmented BNF for Syntax Specifications: ABNF"</span>, <span class="seriesInfo">STD 68</span>, <span class="seriesInfo">RFC 5234</span>, <span class="seriesInfo">DOI 10.17487/RFC5234</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="URL">[URL]</dt>
      <dd>
<span class="refAuthor">van Kesteren, A.</span>, <span class="refTitle">"URL"</span>, <span>n.d.</span>, <span>&lt;<a href="https://url.spec.whatwg.org">https://url.spec.whatwg.org</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CSRF">[CSRF]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refAuthor">Jackson, C.</span>, and <span class="refAuthor">J. Mitchell</span>, <span class="refTitle">"Robust Defenses for Cross-Site Request Forgery"</span>, <span class="seriesInfo">DOI 10.1145/1455770.1455782</span>, <span class="seriesInfo">ISBN 978-1-59593-810-7</span>, <span class="seriesInfo">ACM CCS '08: Proceedings of the 15th ACM conference on Computer and communications security (pages 75-88)</span>, <time datetime="2008-10" class="refDate">October 2008</time>, <span>&lt;<a href="http://portal.acm.org/citation.cfm?id=1455770.1455782">http://portal.acm.org/citation.cfm?id=1455770.1455782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9114">[HTTP]</dt>
        <dd>
<span class="refAuthor">Bishop, M., Ed.</span>, <span class="refTitle">"HTTP/3"</span>, <span class="seriesInfo">RFC 9114</span>, <span class="seriesInfo">DOI 10.17487/RFC9114</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9114">https://www.rfc-editor.org/rfc/rfc9114</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HttpFieldNameRegistry">[HttpFieldNameRegistry]</dt>
        <dd>
<span class="refTitle">"Hypertext Transfer Protocol (HTTP) Field Name Registry"</span>, <span>n.d.</span>, <span>&lt;<a href="https://www.iana.org/assignments/http-fields/">https://www.iana.org/assignments/http-fields/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2109">[RFC2109]</dt>
        <dd>
<span class="refAuthor">Kristol, D.</span> and <span class="refAuthor">L. Montulli</span>, <span class="refTitle">"HTTP State Management Mechanism"</span>, <span class="seriesInfo">RFC 2109</span>, <span class="seriesInfo">DOI 10.17487/RFC2109</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2109">https://www.rfc-editor.org/rfc/rfc2109</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6265">[RFC6265]</dt>
        <dd>
<span class="refAuthor">Barth, A.</span>, <span class="refTitle">"HTTP State Management Mechanism"</span>, <span class="seriesInfo">RFC 6265</span>, <span class="seriesInfo">DOI 10.17487/RFC6265</span>, <time datetime="2011-04" class="refDate">April 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6265">https://www.rfc-editor.org/rfc/rfc6265</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7034">[RFC7034]</dt>
        <dd>
<span class="refAuthor">Ross, D.</span> and <span class="refAuthor">T. Gondrom</span>, <span class="refTitle">"HTTP Header Field X-Frame-Options"</span>, <span class="seriesInfo">RFC 7034</span>, <span class="seriesInfo">DOI 10.17487/RFC7034</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7034">https://www.rfc-editor.org/rfc/rfc7034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9113">[RFC9113]</dt>
        <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">C. Benfield, Ed.</span>, <span class="refTitle">"HTTP/2"</span>, <span class="seriesInfo">RFC 9113</span>, <span class="seriesInfo">DOI 10.17487/RFC9113</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9113">https://www.rfc-editor.org/rfc/rfc9113</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[TLS13]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Anne van Kesteren (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Apple</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:annevk@annevk.nl" class="email">annevk@annevk.nl</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Johann Hofmann (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:johannhof@google.com" class="email">johannhof@google.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
